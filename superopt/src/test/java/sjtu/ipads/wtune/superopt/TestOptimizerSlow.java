package sjtu.ipads.wtune.superopt;

import org.junit.jupiter.api.Test;
import sjtu.ipads.wtune.sqlparser.ast.ASTNode;
import sjtu.ipads.wtune.sqlparser.schema.Schema;
import sjtu.ipads.wtune.stmt.Statement;
import sjtu.ipads.wtune.superopt.optimization.Optimizer;
import sjtu.ipads.wtune.superopt.optimization.SubstitutionBank;

import java.io.IOException;
import java.io.UncheckedIOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.List;

import static org.junit.jupiter.api.Assertions.assertTrue;
import static sjtu.ipads.wtune.stmt.support.Workflow.normalize;

public class TestOptimizerSlow {
  private static SubstitutionBank bank;

  private static SubstitutionBank bank() {
    if (bank != null) return bank;

    bank = SubstitutionBank.make();

    try {
      bank.importFrom(Files.readAllLines(Paths.get("wtune_data", "substitution_bank")));
    } catch (IOException ioe) {
      throw new UncheckedIOException(ioe);
    }

    return bank;
  }

  private static void doTest(String appName, int stmtId, String... expected) {
    final Statement stmt = Statement.findOne(appName, stmtId);
    final ASTNode ast = stmt.parsed();
    final Schema schema = stmt.app().schema("base", true);
    ast.context().setSchema(schema);
    normalize(stmt.parsed());

    final Optimizer optimizer = Optimizer.make(bank(), schema);
    final List<ASTNode> optimized = optimizer.optimize(ast);

    optimized.forEach(System.out::println);
    boolean passed = false;
    for (String s : expected)
      if (optimized.stream().anyMatch(it -> s.equals(it.toString()))) {
        passed = true;
        break;
      }
    assertTrue(passed);
  }

  @Test // 6
  void testDiaspora224() {
    final String appName = "diaspora";
    final int stmtId = 224;
    final String[] expected =
        new String[] {
          "SELECT `people`.`id` AS `id`, `people`.`guid` AS `guid`, `people`.`diaspora_handle` AS `diaspora_handle`, `people`.`serialized_public_key` AS `serialized_public_key`, `people`.`owner_id` AS `owner_id`, `people`.`created_at` AS `created_at`, `people`.`updated_at` AS `updated_at`, `people`.`closed_account` AS `closed_account`, `people`.`fetch_status` AS `fetch_status`, `people`.`pod_id` AS `pod_id` FROM `people` AS `people` INNER JOIN `people` AS `q0` ON `people`.`id` = `q0`.`id` INNER JOIN `contacts` AS `contacts` ON `q0`.`id` = `contacts`.`person_id` INNER JOIN `aspect_memberships` AS `aspect_memberships` ON `contacts`.`id` = `aspect_memberships`.`contact_id` WHERE `q0`.`id` IN (SELECT `people`.`id` FROM `people` INNER JOIN `profiles` ON `profiles`.`person_id` = `people`.`id` INNER JOIN `contacts` AS `contacts_people` ON `contacts_people`.`person_id` = `people`.`id` INNER JOIN `aspect_memberships` ON `aspect_memberships`.`contact_id` = `contacts_people`.`id` LEFT JOIN `contacts` ON `contacts`.`user_id` = 488 AND `contacts`.`person_id` = `people`.`id` WHERE (`profiles`.`searchable` = TRUE OR `contacts`.`user_id` = 488) AND (`profiles`.`full_name` LIKE '%my% aspect% contact%' OR `people`.`diaspora_handle` LIKE 'myaspectcontact%') AND `people`.`closed_account` = FALSE AND `contacts`.`user_id` = 488 AND `aspect_memberships`.`aspect_id` = 321) AND `aspect_memberships`.`aspect_id` = 322 AND `contacts`.`user_id` = 488 LIMIT 15 OFFSET 0",
        };
    doTest(appName, stmtId, expected);
  }

  @Test // 26
  void testDiscourse877() {
    final String appName = "discourse";
    final int stmtId = 877;
    final String[] expected =
        new String[] {
          "SELECT \"posts\".\"id\" AS \"id\", \"posts\".\"user_id\" AS \"user_id\", \"posts\".\"topic_id\" AS \"topic_id\", \"posts\".\"post_number\" AS \"post_number\", \"posts\".\"raw\" AS \"raw\", \"posts\".\"cooked\" AS \"cooked\", \"posts\".\"created_at\" AS \"created_at\", \"posts\".\"updated_at\" AS \"updated_at\", \"posts\".\"reply_to_post_number\" AS \"reply_to_post_number\", \"posts\".\"reply_count\" AS \"reply_count\", \"posts\".\"quote_count\" AS \"quote_count\", \"posts\".\"deleted_at\" AS \"deleted_at\", \"posts\".\"off_topic_count\" AS \"off_topic_count\", \"posts\".\"like_count\" AS \"like_count\", \"posts\".\"incoming_link_count\" AS \"incoming_link_count\", \"posts\".\"bookmark_count\" AS \"bookmark_count\", \"posts\".\"avg_time\" AS \"avg_time\", \"posts\".\"score\" AS \"score\", \"posts\".\"reads\" AS \"reads\", \"posts\".\"post_type\" AS \"post_type\", \"posts\".\"sort_order\" AS \"sort_order\", \"posts\".\"last_editor_id\" AS \"last_editor_id\", \"posts\".\"hidden\" AS \"hidden\", \"posts\".\"hidden_reason_id\" AS \"hidden_reason_id\", \"posts\".\"notify_moderators_count\" AS \"notify_moderators_count\", \"posts\".\"spam_count\" AS \"spam_count\", \"posts\".\"illegal_count\" AS \"illegal_count\", \"posts\".\"inappropriate_count\" AS \"inappropriate_count\", \"posts\".\"last_version_at\" AS \"last_version_at\", \"posts\".\"user_deleted\" AS \"user_deleted\", \"posts\".\"reply_to_user_id\" AS \"reply_to_user_id\", \"posts\".\"percent_rank\" AS \"percent_rank\", \"posts\".\"notify_user_count\" AS \"notify_user_count\", \"posts\".\"like_score\" AS \"like_score\", \"posts\".\"deleted_by_id\" AS \"deleted_by_id\", \"posts\".\"edit_reason\" AS \"edit_reason\", \"posts\".\"word_count\" AS \"word_count\", \"posts\".\"version\" AS \"version\", \"posts\".\"cook_method\" AS \"cook_method\", \"posts\".\"wiki\" AS \"wiki\", \"posts\".\"baked_at\" AS \"baked_at\", \"posts\".\"baked_version\" AS \"baked_version\", \"posts\".\"hidden_at\" AS \"hidden_at\", \"posts\".\"self_edits\" AS \"self_edits\", \"posts\".\"reply_quoted\" AS \"reply_quoted\", \"posts\".\"via_email\" AS \"via_email\", \"posts\".\"raw_email\" AS \"raw_email\", \"posts\".\"public_version\" AS \"public_version\", \"posts\".\"action_code\" AS \"action_code\", \"posts\".\"image_url\" AS \"image_url\", \"posts\".\"locked_by_id\" AS \"locked_by_id\" FROM \"posts\" AS \"posts\" INNER JOIN \"topics\" AS \"topics\" ON \"posts\".\"topic_id\" = \"topics\".\"id\" INNER JOIN \"group_users\" AS \"group_users\" ON \"posts\".\"user_id\" = \"group_users\".\"user_id\" WHERE NOT \"posts\".\"deleted_at\" IS NULL AND NOT \"topics\".\"deleted_at\" IS NULL AND \"group_users\".\"group_id\" = 2412 AND \"posts\".\"post_type\" = 1 AND \"topics\".\"archetype\" <> 'private_message' AND (\"topics\".\"category_id\" IS NULL OR \"topics\".\"category_id\" IN ($1)) AND \"topics\".\"visible\" IS TRUE ORDER BY \"created_at\" DESC LIMIT 50",
        };
    doTest(appName, stmtId, expected);
  }

  @Test // 34
  void testDiscourse1000() {
    final String appName = "discourse";
    final int stmtId = 1000;
    final String[] expected =
        new String[] {
          "SELECT \"posts\".\"id\" AS \"id\", \"posts\".\"user_id\" AS \"user_id\", \"posts\".\"topic_id\" AS \"topic_id\", \"posts\".\"post_number\" AS \"post_number\", \"posts\".\"raw\" AS \"raw\", \"posts\".\"cooked\" AS \"cooked\", \"posts\".\"created_at\" AS \"created_at\", \"posts\".\"updated_at\" AS \"updated_at\", \"posts\".\"reply_to_post_number\" AS \"reply_to_post_number\", \"posts\".\"reply_count\" AS \"reply_count\", \"posts\".\"quote_count\" AS \"quote_count\", \"posts\".\"deleted_at\" AS \"deleted_at\", \"posts\".\"off_topic_count\" AS \"off_topic_count\", \"posts\".\"like_count\" AS \"like_count\", \"posts\".\"incoming_link_count\" AS \"incoming_link_count\", \"posts\".\"bookmark_count\" AS \"bookmark_count\", \"posts\".\"avg_time\" AS \"avg_time\", \"posts\".\"score\" AS \"score\", \"posts\".\"reads\" AS \"reads\", \"posts\".\"post_type\" AS \"post_type\", \"posts\".\"sort_order\" AS \"sort_order\", \"posts\".\"last_editor_id\" AS \"last_editor_id\", \"posts\".\"hidden\" AS \"hidden\", \"posts\".\"hidden_reason_id\" AS \"hidden_reason_id\", \"posts\".\"notify_moderators_count\" AS \"notify_moderators_count\", \"posts\".\"spam_count\" AS \"spam_count\", \"posts\".\"illegal_count\" AS \"illegal_count\", \"posts\".\"inappropriate_count\" AS \"inappropriate_count\", \"posts\".\"last_version_at\" AS \"last_version_at\", \"posts\".\"user_deleted\" AS \"user_deleted\", \"posts\".\"reply_to_user_id\" AS \"reply_to_user_id\", \"posts\".\"percent_rank\" AS \"percent_rank\", \"posts\".\"notify_user_count\" AS \"notify_user_count\", \"posts\".\"like_score\" AS \"like_score\", \"posts\".\"deleted_by_id\" AS \"deleted_by_id\", \"posts\".\"edit_reason\" AS \"edit_reason\", \"posts\".\"word_count\" AS \"word_count\", \"posts\".\"version\" AS \"version\", \"posts\".\"cook_method\" AS \"cook_method\", \"posts\".\"wiki\" AS \"wiki\", \"posts\".\"baked_at\" AS \"baked_at\", \"posts\".\"baked_version\" AS \"baked_version\", \"posts\".\"hidden_at\" AS \"hidden_at\", \"posts\".\"self_edits\" AS \"self_edits\", \"posts\".\"reply_quoted\" AS \"reply_quoted\", \"posts\".\"via_email\" AS \"via_email\", \"posts\".\"raw_email\" AS \"raw_email\", \"posts\".\"public_version\" AS \"public_version\", \"posts\".\"action_code\" AS \"action_code\", \"posts\".\"image_url\" AS \"image_url\", \"posts\".\"locked_by_id\" AS \"locked_by_id\" FROM \"posts\" AS \"posts\" INNER JOIN \"topics\" AS \"topics\" ON \"posts\".\"topic_id\" = \"topics\".\"id\" INNER JOIN \"group_users\" AS \"group_users\" ON \"posts\".\"user_id\" = \"group_users\".\"user_id\" WHERE NOT \"posts\".\"deleted_at\" IS NULL AND NOT \"topics\".\"deleted_at\" IS NULL AND \"group_users\".\"group_id\" = 2561 AND \"posts\".\"post_type\" = 1 AND \"topics\".\"archetype\" <> 'private_message' AND (\"topics\".\"category_id\" IS NULL OR \"topics\".\"category_id\" IN ($1)) AND \"topics\".\"visible\" IS TRUE ORDER BY \"created_at\" DESC LIMIT 20",
        };
    doTest(appName, stmtId, expected);
  }

  //  @Test // 38
  void testDiscourse1173() {
    final String appName = "discourse";
    final int stmtId = 1173;
    final String[] expected = new String[] {};
    doTest(appName, stmtId, expected);
  }

  @Test // 70
  void testDiscourse3825() {
    final String appName = "discourse";
    final int stmtId = 3825;
    final String[] expected =
        new String[] {
          "SELECT \"posts\".\"id\" AS \"id\" FROM \"posts\" AS \"posts\" LEFT JOIN \"topics\" AS \"topics\" ON \"topics\".\"id\" = \"posts\".\"topic_id\" AND NOT \"topics\".\"deleted_at\" IS NULL WHERE NOT \"posts\".\"deleted_at\" IS NULL AND \"posts\".\"id\" IN ($1) AND \"posts\".\"topic_id\" = 15986 AND (\"posts\".\"user_id\" = 915 OR \"posts\".\"post_type\" IN ($1)) ORDER BY \"posts\".\"sort_order\" DESC"
        };
    doTest(appName, stmtId, expected);
  }

  @Test // 71
  void testDiscourse3829() {
    final String appName = "discourse";
    final int stmtId = 3829;
    final String[] expected =
        new String[] {
          "SELECT \"posts\".\"id\" AS \"id\", \"posts\".\"user_id\" AS \"user_id\", \"posts\".\"topic_id\" AS \"topic_id\", \"posts\".\"post_number\" AS \"post_number\", \"posts\".\"raw\" AS \"raw\", \"posts\".\"cooked\" AS \"cooked\", \"posts\".\"created_at\" AS \"created_at\", \"posts\".\"updated_at\" AS \"updated_at\", \"posts\".\"reply_to_post_number\" AS \"reply_to_post_number\", \"posts\".\"reply_count\" AS \"reply_count\", \"posts\".\"quote_count\" AS \"quote_count\", \"posts\".\"deleted_at\" AS \"deleted_at\", \"posts\".\"off_topic_count\" AS \"off_topic_count\", \"posts\".\"like_count\" AS \"like_count\", \"posts\".\"incoming_link_count\" AS \"incoming_link_count\", \"posts\".\"bookmark_count\" AS \"bookmark_count\", \"posts\".\"avg_time\" AS \"avg_time\", \"posts\".\"score\" AS \"score\", \"posts\".\"reads\" AS \"reads\", \"posts\".\"post_type\" AS \"post_type\", \"posts\".\"sort_order\" AS \"sort_order\", \"posts\".\"last_editor_id\" AS \"last_editor_id\", \"posts\".\"hidden\" AS \"hidden\", \"posts\".\"hidden_reason_id\" AS \"hidden_reason_id\", \"posts\".\"notify_moderators_count\" AS \"notify_moderators_count\", \"posts\".\"spam_count\" AS \"spam_count\", \"posts\".\"illegal_count\" AS \"illegal_count\", \"posts\".\"inappropriate_count\" AS \"inappropriate_count\", \"posts\".\"last_version_at\" AS \"last_version_at\", \"posts\".\"user_deleted\" AS \"user_deleted\", \"posts\".\"reply_to_user_id\" AS \"reply_to_user_id\", \"posts\".\"percent_rank\" AS \"percent_rank\", \"posts\".\"notify_user_count\" AS \"notify_user_count\", \"posts\".\"like_score\" AS \"like_score\", \"posts\".\"deleted_by_id\" AS \"deleted_by_id\", \"posts\".\"edit_reason\" AS \"edit_reason\", \"posts\".\"word_count\" AS \"word_count\", \"posts\".\"version\" AS \"version\", \"posts\".\"cook_method\" AS \"cook_method\", \"posts\".\"wiki\" AS \"wiki\", \"posts\".\"baked_at\" AS \"baked_at\", \"posts\".\"baked_version\" AS \"baked_version\", \"posts\".\"hidden_at\" AS \"hidden_at\", \"posts\".\"self_edits\" AS \"self_edits\", \"posts\".\"reply_quoted\" AS \"reply_quoted\", \"posts\".\"via_email\" AS \"via_email\", \"posts\".\"raw_email\" AS \"raw_email\", \"posts\".\"public_version\" AS \"public_version\", \"posts\".\"action_code\" AS \"action_code\", \"posts\".\"image_url\" AS \"image_url\", \"posts\".\"locked_by_id\" AS \"locked_by_id\" FROM \"posts\" AS \"posts\" INNER JOIN \"post_search_data\" AS \"post_search_data\" ON \"posts\".\"id\" = \"post_search_data\".\"post_id\" INNER JOIN \"topics\" AS \"topics\" ON \"posts\".\"topic_id\" = \"topics\".\"id\" INNER JOIN \"categories\" AS \"categories\" ON \"topics\".\"category_id\" = \"categories\".\"id\" INNER JOIN \"topic_tags\" AS \"tt\" ON \"topics\".\"id\" = \"tt\".\"topic_id\" INNER JOIN \"tags\" AS \"tags\" ON \"tt\".\"tag_id\" = \"tags\".\"id\" WHERE LOWER(\"tags\".\"name\") IN ($1) AND NOT \"posts\".\"deleted_at\" IS NULL AND NOT \"posts\".\"topic_id\" IN ($1) AND NOT \"topics\".\"deleted_at\" IS NULL AND (\"categories\".\"id\" IS NULL OR NOT \"categories\".\"read_restricted\" IS TRUE) AND \"posts\".\"post_type\" IN ($1) AND \"topics\".\"archetype\" <> 'private_message' AND \"topics\".\"category_id\" IN ($1) AND \"topics\".\"visible\" IS TRUE ORDER BY \"created_at\" DESC LIMIT 12 OFFSET 0"
        };
    doTest(appName, stmtId, expected);
  }

  @Test // 72
  void testDiscourse3831() {
    final String appName = "discourse";
    final int stmtId = 3831;
    final String[] expected =
        new String[] {
          "SELECT \"posts\".\"id\" AS \"id\", \"posts\".\"user_id\" AS \"user_id\", \"posts\".\"topic_id\" AS \"topic_id\", \"posts\".\"post_number\" AS \"post_number\", \"posts\".\"raw\" AS \"raw\", \"posts\".\"cooked\" AS \"cooked\", \"posts\".\"created_at\" AS \"created_at\", \"posts\".\"updated_at\" AS \"updated_at\", \"posts\".\"reply_to_post_number\" AS \"reply_to_post_number\", \"posts\".\"reply_count\" AS \"reply_count\", \"posts\".\"quote_count\" AS \"quote_count\", \"posts\".\"deleted_at\" AS \"deleted_at\", \"posts\".\"off_topic_count\" AS \"off_topic_count\", \"posts\".\"like_count\" AS \"like_count\", \"posts\".\"incoming_link_count\" AS \"incoming_link_count\", \"posts\".\"bookmark_count\" AS \"bookmark_count\", \"posts\".\"avg_time\" AS \"avg_time\", \"posts\".\"score\" AS \"score\", \"posts\".\"reads\" AS \"reads\", \"posts\".\"post_type\" AS \"post_type\", \"posts\".\"sort_order\" AS \"sort_order\", \"posts\".\"last_editor_id\" AS \"last_editor_id\", \"posts\".\"hidden\" AS \"hidden\", \"posts\".\"hidden_reason_id\" AS \"hidden_reason_id\", \"posts\".\"notify_moderators_count\" AS \"notify_moderators_count\", \"posts\".\"spam_count\" AS \"spam_count\", \"posts\".\"illegal_count\" AS \"illegal_count\", \"posts\".\"inappropriate_count\" AS \"inappropriate_count\", \"posts\".\"last_version_at\" AS \"last_version_at\", \"posts\".\"user_deleted\" AS \"user_deleted\", \"posts\".\"reply_to_user_id\" AS \"reply_to_user_id\", \"posts\".\"percent_rank\" AS \"percent_rank\", \"posts\".\"notify_user_count\" AS \"notify_user_count\", \"posts\".\"like_score\" AS \"like_score\", \"posts\".\"deleted_by_id\" AS \"deleted_by_id\", \"posts\".\"edit_reason\" AS \"edit_reason\", \"posts\".\"word_count\" AS \"word_count\", \"posts\".\"version\" AS \"version\", \"posts\".\"cook_method\" AS \"cook_method\", \"posts\".\"wiki\" AS \"wiki\", \"posts\".\"baked_at\" AS \"baked_at\", \"posts\".\"baked_version\" AS \"baked_version\", \"posts\".\"hidden_at\" AS \"hidden_at\", \"posts\".\"self_edits\" AS \"self_edits\", \"posts\".\"reply_quoted\" AS \"reply_quoted\", \"posts\".\"via_email\" AS \"via_email\", \"posts\".\"raw_email\" AS \"raw_email\", \"posts\".\"public_version\" AS \"public_version\", \"posts\".\"action_code\" AS \"action_code\", \"posts\".\"image_url\" AS \"image_url\", \"posts\".\"locked_by_id\" AS \"locked_by_id\" FROM \"posts\" AS \"posts\" INNER JOIN \"post_search_data\" AS \"post_search_data\" ON \"posts\".\"id\" = \"post_search_data\".\"post_id\" INNER JOIN \"topics\" AS \"topics\" ON \"posts\".\"topic_id\" = \"topics\".\"id\" INNER JOIN \"categories\" AS \"categories\" ON \"topics\".\"category_id\" = \"categories\".\"id\" INNER JOIN \"topic_tags\" AS \"tt\" ON \"topics\".\"id\" = \"tt\".\"topic_id\" INNER JOIN \"tags\" AS \"tags\" ON \"tt\".\"tag_id\" = \"tags\".\"id\" WHERE LOWER(\"tags\".\"name\") IN ($1) AND NOT \"posts\".\"deleted_at\" IS NULL AND NOT \"posts\".\"topic_id\" IN ($1) AND NOT \"topics\".\"deleted_at\" IS NULL AND (\"categories\".\"id\" IS NULL OR NOT \"categories\".\"read_restricted\" IS TRUE) AND \"posts\".\"post_type\" IN ($1) AND \"topics\".\"archetype\" <> 'private_message' AND \"topics\".\"category_id\" IN ($1) AND \"topics\".\"visible\" IS TRUE ORDER BY \"like_count\" DESC LIMIT 12 OFFSET 0"
        };
    doTest(appName, stmtId, expected);
  }

  @Test // 73
  void testDiscourse3842() {
    final String appName = "discourse";
    final int stmtId = 3842;
    final String[] expected =
        new String[] {
          "SELECT \"posts\".\"id\" AS \"id\", \"posts\".\"user_id\" AS \"user_id\", \"posts\".\"topic_id\" AS \"topic_id\", \"posts\".\"post_number\" AS \"post_number\", \"posts\".\"raw\" AS \"raw\", \"posts\".\"cooked\" AS \"cooked\", \"posts\".\"created_at\" AS \"created_at\", \"posts\".\"updated_at\" AS \"updated_at\", \"posts\".\"reply_to_post_number\" AS \"reply_to_post_number\", \"posts\".\"reply_count\" AS \"reply_count\", \"posts\".\"quote_count\" AS \"quote_count\", \"posts\".\"deleted_at\" AS \"deleted_at\", \"posts\".\"off_topic_count\" AS \"off_topic_count\", \"posts\".\"like_count\" AS \"like_count\", \"posts\".\"incoming_link_count\" AS \"incoming_link_count\", \"posts\".\"bookmark_count\" AS \"bookmark_count\", \"posts\".\"avg_time\" AS \"avg_time\", \"posts\".\"score\" AS \"score\", \"posts\".\"reads\" AS \"reads\", \"posts\".\"post_type\" AS \"post_type\", \"posts\".\"sort_order\" AS \"sort_order\", \"posts\".\"last_editor_id\" AS \"last_editor_id\", \"posts\".\"hidden\" AS \"hidden\", \"posts\".\"hidden_reason_id\" AS \"hidden_reason_id\", \"posts\".\"notify_moderators_count\" AS \"notify_moderators_count\", \"posts\".\"spam_count\" AS \"spam_count\", \"posts\".\"illegal_count\" AS \"illegal_count\", \"posts\".\"inappropriate_count\" AS \"inappropriate_count\", \"posts\".\"last_version_at\" AS \"last_version_at\", \"posts\".\"user_deleted\" AS \"user_deleted\", \"posts\".\"reply_to_user_id\" AS \"reply_to_user_id\", \"posts\".\"percent_rank\" AS \"percent_rank\", \"posts\".\"notify_user_count\" AS \"notify_user_count\", \"posts\".\"like_score\" AS \"like_score\", \"posts\".\"deleted_by_id\" AS \"deleted_by_id\", \"posts\".\"edit_reason\" AS \"edit_reason\", \"posts\".\"word_count\" AS \"word_count\", \"posts\".\"version\" AS \"version\", \"posts\".\"cook_method\" AS \"cook_method\", \"posts\".\"wiki\" AS \"wiki\", \"posts\".\"baked_at\" AS \"baked_at\", \"posts\".\"baked_version\" AS \"baked_version\", \"posts\".\"hidden_at\" AS \"hidden_at\", \"posts\".\"self_edits\" AS \"self_edits\", \"posts\".\"reply_quoted\" AS \"reply_quoted\", \"posts\".\"via_email\" AS \"via_email\", \"posts\".\"raw_email\" AS \"raw_email\", \"posts\".\"public_version\" AS \"public_version\", \"posts\".\"action_code\" AS \"action_code\", \"posts\".\"image_url\" AS \"image_url\", \"posts\".\"locked_by_id\" AS \"locked_by_id\" FROM \"posts\" AS \"posts\" INNER JOIN \"post_search_data\" AS \"post_search_data\" ON \"posts\".\"id\" = \"post_search_data\".\"post_id\" INNER JOIN \"topics\" AS \"topics\" ON \"posts\".\"topic_id\" = \"topics\".\"id\" INNER JOIN \"categories\" AS \"categories\" ON \"topics\".\"category_id\" = \"categories\".\"id\" INNER JOIN \"topic_tags\" AS \"tt\" ON \"topics\".\"id\" = \"tt\".\"topic_id\" INNER JOIN \"tags\" AS \"tags\" ON \"tt\".\"tag_id\" = \"tags\".\"id\" WHERE LOWER(\"tags\".\"name\") IN ($1) AND NOT \"categories\".\"id\" IN (SELECT \"categories\".\"id\" WHERE \"categories\".\"search_priority\" = 1) AND NOT \"posts\".\"deleted_at\" IS NULL AND NOT \"posts\".\"topic_id\" IN ($1) AND NOT \"topics\".\"deleted_at\" IS NULL AND (\"categories\".\"id\" IS NULL OR NOT \"categories\".\"read_restricted\" IS TRUE) AND \"posts\".\"post_type\" IN ($1) AND \"topics\".\"archetype\" <> 'private_message' AND \"topics\".\"visible\" IS TRUE ORDER BY \"created_at\" DESC LIMIT 15 OFFSET 0"
        };
    doTest(appName, stmtId, expected);
  }

  //  @Test // 123
  void testShopizer3() {
    final String appName = "shopizer";
    final int stmtId = 3;
    final String[] expected =
        new String[] {
          "SELECT `product0_`.`product_id` AS `product_1_42_0_`, `availabili1_`.`product_avail_id` AS `product_1_44_1_`, `prices7_`.`product_price_id` AS `product_1_54_2_`, `descriptio8_`.`description_id` AS `descript1_55_3_`, `merchantst2_`.`merchant_id` AS `merchant1_27_4_`, `descriptio3_`.`description_id` AS `descript1_46_5_`, `category5_`.`category_id` AS `category1_0_6_`, `descriptio6_`.`description_id` AS `descript1_1_7_`, `images9_`.`product_image_id` AS `product_1_48_8_`, `attributes10_`.`product_attribute_id` AS `product_1_43_9_`, `productopt11_`.`product_option_id` AS `product_1_50_10_`, `descriptio12_`.`description_id` AS `descript1_51_11_`, `productopt13_`.`product_option_value_id` AS `product_1_52_12_`, `descriptio14_`.`description_id` AS `descript1_53_13_`, `relationsh15_`.`product_relationship_id` AS `product_1_56_14_`, `manufactur16_`.`manufacturer_id` AS `manufact1_22_15_`, `descriptio17_`.`description_id` AS `descript1_23_16_`, `producttyp18_`.`product_type_id` AS `product_1_59_17_`, `taxclass19_`.`tax_class_id` AS `tax_clas1_69_18_`, `customer20_`.`customer_id` AS `customer1_7_19_`, `product0_`.`date_created` AS `date_cre2_42_0_`, `product0_`.`date_modified` AS `date_mod3_42_0_`, `product0_`.`updt_id` AS `updt_id4_42_0_`, `product0_`.`available` AS `availabl5_42_0_`, `product0_`.`cond` AS `cond6_42_0_`, `product0_`.`date_available` AS `date_ava7_42_0_`, `product0_`.`manufacturer_id` AS `manufac25_42_0_`, `product0_`.`merchant_id` AS `merchan26_42_0_`, `product0_`.`customer_id` AS `custome27_42_0_`, `product0_`.`preorder` AS `preorder8_42_0_`, `product0_`.`product_height` AS `product_9_42_0_`, `product0_`.`product_free` AS `product10_42_0_`, `product0_`.`product_length` AS `product11_42_0_`, `product0_`.`quantity_ordered` AS `quantit12_42_0_`, `product0_`.`review_avg` AS `review_13_42_0_`, `product0_`.`review_count` AS `review_14_42_0_`, `product0_`.`product_ship` AS `product15_42_0_`, `product0_`.`product_virtual` AS `product16_42_0_`, `product0_`.`product_weight` AS `product17_42_0_`, `product0_`.`product_width` AS `product18_42_0_`, `product0_`.`ref_sku` AS `ref_sku19_42_0_`, `product0_`.`rental_duration` AS `rental_20_42_0_`, `product0_`.`rental_period` AS `rental_21_42_0_`, `product0_`.`rental_status` AS `rental_22_42_0_`, `product0_`.`sku` AS `sku23_42_0_`, `product0_`.`sort_order` AS `sort_or24_42_0_`, `product0_`.`tax_class_id` AS `tax_cla28_42_0_`, `product0_`.`product_type_id` AS `product29_42_0_`, `availabili1_`.`product_id` AS `product10_44_1_`, `availabili1_`.`date_available` AS `date_ava2_44_1_`, `availabili1_`.`free_shipping` AS `free_shi3_44_1_`, `availabili1_`.`quantity` AS `quantity4_44_1_`, `availabili1_`.`quantity_ord_max` AS `quantity5_44_1_`, `availabili1_`.`quantity_ord_min` AS `quantity6_44_1_`, `availabili1_`.`status` AS `status7_44_1_`, `availabili1_`.`region` AS `region8_44_1_`, `availabili1_`.`region_variant` AS `region_v9_44_1_`, `availabili1_`.`product_id` AS `product10_44_0__`, `availabili1_`.`product_avail_id` AS `product_1_44_0__`, `prices7_`.`product_price_code` AS `product_2_54_2_`, `prices7_`.`default_price` AS `default_3_54_2_`, `prices7_`.`product_avail_id` AS `product_9_54_2_`, `prices7_`.`product_price_amount` AS `product_4_54_2_`, `prices7_`.`product_price_special_amount` AS `product_5_54_2_`, `prices7_`.`product_price_special_end_date` AS `product_6_54_2_`, `prices7_`.`product_price_special_st_date` AS `product_7_54_2_`, `prices7_`.`product_price_type` AS `product_8_54_2_`, `prices7_`.`product_avail_id` AS `product_9_54_1__`, `prices7_`.`product_price_id` AS `product_1_54_1__`, `descriptio8_`.`date_created` AS `date_cre2_55_3_`, `descriptio8_`.`date_modified` AS `date_mod3_55_3_`, `descriptio8_`.`updt_id` AS `updt_id4_55_3_`, `descriptio8_`.`description` AS `descript5_55_3_`, `descriptio8_`.`language_id` AS `language8_55_3_`, `descriptio8_`.`name` AS `name6_55_3_`, `descriptio8_`.`title` AS `title7_55_3_`, `descriptio8_`.`product_price_id` AS `product_9_55_3_`, `descriptio8_`.`product_price_id` AS `product_9_55_2__`, `descriptio8_`.`description_id` AS `descript1_55_2__`, `merchantst2_`.`date_created` AS `date_cre2_27_4_`, `merchantst2_`.`date_modified` AS `date_mod3_27_4_`, `merchantst2_`.`updt_id` AS `updt_id4_27_4_`, `merchantst2_`.`store_code` AS `store_co5_27_4_`, `merchantst2_`.`continueshoppingurl` AS `continue6_27_4_`, `merchantst2_`.`country_id` AS `country23_27_4_`, `merchantst2_`.`currency_id` AS `currenc24_27_4_`, `merchantst2_`.`currency_format_national` AS `currency7_27_4_`, `merchantst2_`.`language_id` AS `languag25_27_4_`, `merchantst2_`.`domain_name` AS `domain_n8_27_4_`, `merchantst2_`.`in_business_since` AS `in_busin9_27_4_`, `merchantst2_`.`invoice_template` AS `invoice10_27_4_`, `merchantst2_`.`seizeunitcode` AS `seizeun11_27_4_`, `merchantst2_`.`store_email` AS `store_e12_27_4_`, `merchantst2_`.`store_logo` AS `store_l13_27_4_`, `merchantst2_`.`store_template` AS `store_t14_27_4_`, `merchantst2_`.`store_address` AS `store_a15_27_4_`, `merchantst2_`.`store_city` AS `store_c16_27_4_`, `merchantst2_`.`store_name` AS `store_n17_27_4_`, `merchantst2_`.`store_phone` AS `store_p18_27_4_`, `merchantst2_`.`store_postal_code` AS `store_p19_27_4_`, `merchantst2_`.`store_state_prov` AS `store_s20_27_4_`, `merchantst2_`.`use_cache` AS `use_cac21_27_4_`, `merchantst2_`.`weightunitcode` AS `weightu22_27_4_`, `merchantst2_`.`zone_id` AS `zone_id26_27_4_`, `descriptio3_`.`date_created` AS `date_cre2_46_5_`, `descriptio3_`.`date_modified` AS `date_mod3_46_5_`, `descriptio3_`.`updt_id` AS `updt_id4_46_5_`, `descriptio3_`.`description` AS `descript5_46_5_`, `descriptio3_`.`language_id` AS `languag14_46_5_`, `descriptio3_`.`name` AS `name6_46_5_`, `descriptio3_`.`title` AS `title7_46_5_`, `descriptio3_`.`meta_description` AS `meta_des8_46_5_`, `descriptio3_`.`meta_keywords` AS `meta_key9_46_5_`, `descriptio3_`.`meta_title` AS `meta_ti10_46_5_`, `descriptio3_`.`product_id` AS `product15_46_5_`, `descriptio3_`.`download_lnk` AS `downloa11_46_5_`, `descriptio3_`.`product_highlight` AS `product12_46_5_`, `descriptio3_`.`sef_url` AS `sef_url13_46_5_`, `descriptio3_`.`product_id` AS `product15_46_3__`, `descriptio3_`.`description_id` AS `descript1_46_3__`, `category5_`.`date_created` AS `date_cre2_0_6_`, `category5_`.`date_modified` AS `date_mod3_0_6_`, `category5_`.`updt_id` AS `updt_id4_0_6_`, `category5_`.`category_image` AS `category5_0_6_`, `category5_`.`category_status` AS `category6_0_6_`, `category5_`.`code` AS `code7_0_6_`, `category5_`.`depth` AS `depth8_0_6_`, `category5_`.`featured` AS `featured9_0_6_`, `category5_`.`lineage` AS `lineage10_0_6_`, `category5_`.`merchant_id` AS `merchan13_0_6_`, `category5_`.`parent_id` AS `parent_14_0_6_`, `category5_`.`sort_order` AS `sort_or11_0_6_`, `category5_`.`visible` AS `visible12_0_6_`, `categories4_`.`product_id` AS `product_1_45_4__`, `categories4_`.`category_id` AS `category2_45_4__`, `descriptio6_`.`date_created` AS `date_cre2_1_7_`, `descriptio6_`.`date_modified` AS `date_mod3_1_7_`, `descriptio6_`.`updt_id` AS `updt_id4_1_7_`, `descriptio6_`.`description` AS `descript5_1_7_`, `descriptio6_`.`language_id` AS `languag13_1_7_`, `descriptio6_`.`name` AS `name6_1_7_`, `descriptio6_`.`title` AS `title7_1_7_`, `descriptio6_`.`category_id` AS `categor14_1_7_`, `descriptio6_`.`category_highlight` AS `category8_1_7_`, `descriptio6_`.`meta_description` AS `meta_des9_1_7_`, `descriptio6_`.`meta_keywords` AS `meta_ke10_1_7_`, `descriptio6_`.`meta_title` AS `meta_ti11_1_7_`, `descriptio6_`.`sef_url` AS `sef_url12_1_7_`, `descriptio6_`.`category_id` AS `categor14_1_5__`, `descriptio6_`.`description_id` AS `descript1_1_5__`, `images9_`.`default_image` AS `default_2_48_8_`, `images9_`.`image_crop` AS `image_cr3_48_8_`, `images9_`.`image_type` AS `image_ty4_48_8_`, `images9_`.`product_id` AS `product_7_48_8_`, `images9_`.`product_image` AS `product_5_48_8_`, `images9_`.`product_image_url` AS `product_6_48_8_`, `images9_`.`product_id` AS `product_7_48_6__`, `images9_`.`product_image_id` AS `product_1_48_6__`, `attributes10_`.`product_attribute_default` AS `product_2_43_9_`, `attributes10_`.`product_attribute_discounted` AS `product_3_43_9_`, `attributes10_`.`product_attribute_for_disp` AS `product_4_43_9_`, `attributes10_`.`product_attribute_required` AS `product_5_43_9_`, `attributes10_`.`product_id` AS `product10_43_9_`, `attributes10_`.`product_attribute_free` AS `product_6_43_9_`, `attributes10_`.`product_atribute_price` AS `product_7_43_9_`, `attributes10_`.`product_attribute_weight` AS `product_8_43_9_`, `attributes10_`.`option_id` AS `option_11_43_9_`, `attributes10_`.`product_attribute_sort_ord` AS `product_9_43_9_`, `attributes10_`.`option_value_id` AS `option_12_43_9_`, `attributes10_`.`product_id` AS `product10_43_7__`, `attributes10_`.`product_attribute_id` AS `product_1_43_7__`, `productopt11_`.`product_option_code` AS `product_2_50_10_`, `productopt11_`.`merchant_id` AS `merchant6_50_10_`, `productopt11_`.`product_option_sort_ord` AS `product_3_50_10_`, `productopt11_`.`product_option_type` AS `product_4_50_10_`, `productopt11_`.`product_option_read` AS `product_5_50_10_`, `descriptio12_`.`date_created` AS `date_cre2_51_11_`, `descriptio12_`.`date_modified` AS `date_mod3_51_11_`, `descriptio12_`.`updt_id` AS `updt_id4_51_11_`, `descriptio12_`.`description` AS `descript5_51_11_`, `descriptio12_`.`language_id` AS `language9_51_11_`, `descriptio12_`.`name` AS `name6_51_11_`, `descriptio12_`.`title` AS `title7_51_11_`, `descriptio12_`.`product_option_id` AS `product10_51_11_`, `descriptio12_`.`product_option_comment` AS `product_8_51_11_`, `descriptio12_`.`product_option_id` AS `product10_51_8__`, `descriptio12_`.`description_id` AS `descript1_51_8__`, `productopt13_`.`product_option_val_code` AS `product_2_52_12_`, `productopt13_`.`merchant_id` AS `merchant6_52_12_`, `productopt13_`.`product_opt_for_disp` AS `product_3_52_12_`, `productopt13_`.`product_opt_val_image` AS `product_4_52_12_`, `productopt13_`.`product_opt_val_sort_ord` AS `product_5_52_12_`, `descriptio14_`.`date_created` AS `date_cre2_53_13_`, `descriptio14_`.`date_modified` AS `date_mod3_53_13_`, `descriptio14_`.`updt_id` AS `updt_id4_53_13_`, `descriptio14_`.`description` AS `descript5_53_13_`, `descriptio14_`.`language_id` AS `language8_53_13_`, `descriptio14_`.`name` AS `name6_53_13_`, `descriptio14_`.`title` AS `title7_53_13_`, `descriptio14_`.`product_option_value_id` AS `product_9_53_13_`, `descriptio14_`.`product_option_value_id` AS `product_9_53_9__`, `descriptio14_`.`description_id` AS `descript1_53_9__`, `relationsh15_`.`active` AS `active2_56_14_`, `relationsh15_`.`code` AS `code3_56_14_`, `relationsh15_`.`product_id` AS `product_4_56_14_`, `relationsh15_`.`related_product_id` AS `related_5_56_14_`, `relationsh15_`.`merchant_id` AS `merchant6_56_14_`, `relationsh15_`.`product_id` AS `product_4_56_10__`, `relationsh15_`.`product_relationship_id` AS `product_1_56_10__`, `manufactur16_`.`date_created` AS `date_cre2_22_15_`, `manufactur16_`.`date_modified` AS `date_mod3_22_15_`, `manufactur16_`.`updt_id` AS `updt_id4_22_15_`, `manufactur16_`.`code` AS `code5_22_15_`, `manufactur16_`.`manufacturer_image` AS `manufact6_22_15_`, `manufactur16_`.`merchant_id` AS `merchant8_22_15_`, `manufactur16_`.`sort_order` AS `sort_ord7_22_15_`, `descriptio17_`.`date_created` AS `date_cre2_23_16_`, `descriptio17_`.`date_modified` AS `date_mod3_23_16_`, `descriptio17_`.`updt_id` AS `updt_id4_23_16_`, `descriptio17_`.`description` AS `descript5_23_16_`, `descriptio17_`.`language_id` AS `languag11_23_16_`, `descriptio17_`.`name` AS `name6_23_16_`, `descriptio17_`.`title` AS `title7_23_16_`, `descriptio17_`.`date_last_click` AS `date_las8_23_16_`, `descriptio17_`.`manufacturer_id` AS `manufac12_23_16_`, `descriptio17_`.`manufacturers_url` AS `manufact9_23_16_`, `descriptio17_`.`url_clicked` AS `url_cli10_23_16_`, `descriptio17_`.`manufacturer_id` AS `manufac12_23_11__`, `descriptio17_`.`description_id` AS `descript1_23_11__`, `producttyp18_`.`prd_type_add_to_cart` AS `prd_type2_59_17_`, `producttyp18_`.`date_created` AS `date_cre3_59_17_`, `producttyp18_`.`date_modified` AS `date_mod4_59_17_`, `producttyp18_`.`updt_id` AS `updt_id5_59_17_`, `producttyp18_`.`prd_type_code` AS `prd_type6_59_17_`, `taxclass19_`.`tax_class_code` AS `tax_clas2_69_18_`, `taxclass19_`.`merchant_id` AS `merchant4_69_18_`, `taxclass19_`.`tax_class_title` AS `tax_clas3_69_18_`, `customer20_`.`customer_anonymous` AS `customer2_7_19_`, `customer20_`.`date_created` AS `date_cre3_7_19_`, `customer20_`.`date_modified` AS `date_mod4_7_19_`, `customer20_`.`updt_id` AS `updt_id5_7_19_`, `customer20_`.`billing_street_address` AS `billing_6_7_19_`, `customer20_`.`billing_city` AS `billing_7_7_19_`, `customer20_`.`billing_company` AS `billing_8_7_19_`, `customer20_`.`billing_country_id` AS `billing33_7_19_`, `customer20_`.`billing_first_name` AS `billing_9_7_19_`, `customer20_`.`billing_last_name` AS `billing10_7_19_`, `customer20_`.`latitude` AS `latitud11_7_19_`, `customer20_`.`longitude` AS `longitu12_7_19_`, `customer20_`.`billing_postcode` AS `billing13_7_19_`, `customer20_`.`billing_state` AS `billing14_7_19_`, `customer20_`.`billing_telephone` AS `billing15_7_19_`, `customer20_`.`billing_zone_id` AS `billing34_7_19_`, `customer20_`.`customer_company` AS `custome16_7_19_`, `customer20_`.`review_avg` AS `review_17_7_19_`, `customer20_`.`review_count` AS `review_18_7_19_`, `customer20_`.`customer_dob` AS `custome19_7_19_`, `customer20_`.`language_id` AS `languag35_7_19_`, `customer20_`.`delivery_street_address` AS `deliver20_7_19_`, `customer20_`.`delivery_city` AS `deliver21_7_19_`, `customer20_`.`delivery_company` AS `deliver22_7_19_`, `customer20_`.`delivery_country_id` AS `deliver36_7_19_`, `customer20_`.`delivery_first_name` AS `deliver23_7_19_`, `customer20_`.`delivery_last_name` AS `deliver24_7_19_`, `customer20_`.`delivery_postcode` AS `deliver25_7_19_`, `customer20_`.`delivery_state` AS `deliver26_7_19_`, `customer20_`.`delivery_telephone` AS `deliver27_7_19_`, `customer20_`.`delivery_zone_id` AS `deliver37_7_19_`, `customer20_`.`customer_email_address` AS `custome28_7_19_`, `customer20_`.`customer_gender` AS `custome29_7_19_`, `customer20_`.`merchant_id` AS `merchan38_7_19_`, `customer20_`.`customer_nick` AS `custome30_7_19_`, `customer20_`.`customer_password` AS `custome31_7_19_`, `customer20_`.`provider` AS `provide32_7_19_` FROM `product` AS `product0_` INNER JOIN `customer` AS `customer20_` ON `product0_`.`customer_id` = `customer20_`.`customer_id` INNER JOIN `merchant_store` AS `merchantst2_` ON `product0_`.`merchant_id` = `merchantst2_`.`merchant_id` INNER JOIN `product_availability` AS `availabili1_` ON `product0_`.`product_id` = `availabili1_`.`product_id` INNER JOIN `product_description` AS `descriptio3_` ON `product0_`.`product_id` = `descriptio3_`.`product_id` INNER JOIN `product_type` AS `producttyp18_` ON `product0_`.`product_type_id` = `producttyp18_`.`product_type_id` INNER JOIN `tax_class` AS `taxclass19_` ON `product0_`.`tax_class_id` = `taxclass19_`.`tax_class_id` LEFT JOIN `manufacturer` AS `manufactur16_` ON `product0_`.`manufacturer_id` = `manufactur16_`.`manufacturer_id` LEFT JOIN `product_attribute` AS `attributes10_` ON `product0_`.`product_id` = `attributes10_`.`product_id` LEFT JOIN `product_category` AS `categories4_` ON `product0_`.`product_id` = `categories4_`.`product_id` LEFT JOIN `product_image` AS `images9_` ON `product0_`.`product_id` = `images9_`.`product_id` LEFT JOIN `product_relationship` AS `relationsh15_` ON `product0_`.`product_id` = `relationsh15_`.`product_id` LEFT JOIN `product_price` AS `prices7_` ON `availabili1_`.`product_avail_id` = `prices7_`.`product_avail_id` LEFT JOIN `manufacturer_description` AS `descriptio17_` ON `manufactur16_`.`manufacturer_id` = `descriptio17_`.`manufacturer_id` LEFT JOIN `product_option` AS `productopt11_` ON `attributes10_`.`option_id` = `productopt11_`.`product_option_id` LEFT JOIN `product_option_value` AS `productopt13_` ON `attributes10_`.`option_value_id` = `productopt13_`.`product_option_value_id` LEFT JOIN `category` AS `category5_` ON `categories4_`.`category_id` = `category5_`.`category_id` LEFT JOIN `product_price_description` AS `descriptio8_` ON `prices7_`.`product_price_id` = `descriptio8_`.`product_price_id` LEFT JOIN `product_option_desc` AS `descriptio12_` ON `productopt11_`.`product_option_id` = `descriptio12_`.`product_option_id` LEFT JOIN `product_option_value_description` AS `descriptio14_` ON `productopt13_`.`product_option_value_id` = `descriptio14_`.`product_option_value_id` LEFT JOIN `category_description` AS `descriptio6_` ON `category5_`.`category_id` = `descriptio6_`.`category_id` WHERE `product0_`.`product_id` = 2",
        };
    doTest(appName, stmtId, expected);
  }

  //  @Test // 126
  void testShopizer24() {
    final String appName = "shopizer";
    final int stmtId = 24;
    final String[] expected =
        new String[] {
          "SELECT `product0_`.`product_id` AS `product_1_42_0_`, `availabili1_`.`product_avail_id` AS `product_1_44_1_`, `prices4_`.`product_price_id` AS `product_1_54_2_`, `descriptio5_`.`description_id` AS `descript1_55_3_`, `descriptio2_`.`description_id` AS `descript1_46_4_`, `merchantst3_`.`merchant_id` AS `merchant1_27_5_`, `category7_`.`category_id` AS `category1_0_6_`, `descriptio8_`.`description_id` AS `descript1_1_7_`, `images9_`.`product_image_id` AS `product_1_48_8_`, `attributes10_`.`product_attribute_id` AS `product_1_43_9_`, `productopt11_`.`product_option_id` AS `product_1_50_10_`, `descriptio12_`.`description_id` AS `descript1_51_11_`, `productopt13_`.`product_option_value_id` AS `product_1_52_12_`, `descriptio14_`.`description_id` AS `descript1_53_13_`, `relationsh15_`.`product_relationship_id` AS `product_1_56_14_`, `manufactur16_`.`manufacturer_id` AS `manufact1_22_15_`, `descriptio17_`.`description_id` AS `descript1_23_16_`, `producttyp18_`.`product_type_id` AS `product_1_59_17_`, `taxclass19_`.`tax_class_id` AS `tax_clas1_69_18_`, `customer20_`.`customer_id` AS `customer1_7_19_`, `product0_`.`date_created` AS `date_cre2_42_0_`, `product0_`.`date_modified` AS `date_mod3_42_0_`, `product0_`.`updt_id` AS `updt_id4_42_0_`, `product0_`.`available` AS `availabl5_42_0_`, `product0_`.`cond` AS `cond6_42_0_`, `product0_`.`date_available` AS `date_ava7_42_0_`, `product0_`.`manufacturer_id` AS `manufac25_42_0_`, `product0_`.`merchant_id` AS `merchan26_42_0_`, `product0_`.`customer_id` AS `custome27_42_0_`, `product0_`.`preorder` AS `preorder8_42_0_`, `product0_`.`product_height` AS `product_9_42_0_`, `product0_`.`product_free` AS `product10_42_0_`, `product0_`.`product_length` AS `product11_42_0_`, `product0_`.`quantity_ordered` AS `quantit12_42_0_`, `product0_`.`review_avg` AS `review_13_42_0_`, `product0_`.`review_count` AS `review_14_42_0_`, `product0_`.`product_ship` AS `product15_42_0_`, `product0_`.`product_virtual` AS `product16_42_0_`, `product0_`.`product_weight` AS `product17_42_0_`, `product0_`.`product_width` AS `product18_42_0_`, `product0_`.`ref_sku` AS `ref_sku19_42_0_`, `product0_`.`rental_duration` AS `rental_20_42_0_`, `product0_`.`rental_period` AS `rental_21_42_0_`, `product0_`.`rental_status` AS `rental_22_42_0_`, `product0_`.`sku` AS `sku23_42_0_`, `product0_`.`sort_order` AS `sort_or24_42_0_`, `product0_`.`tax_class_id` AS `tax_cla28_42_0_`, `product0_`.`product_type_id` AS `product29_42_0_`, `availabili1_`.`product_id` AS `product10_44_1_`, `availabili1_`.`date_available` AS `date_ava2_44_1_`, `availabili1_`.`free_shipping` AS `free_shi3_44_1_`, `availabili1_`.`quantity` AS `quantity4_44_1_`, `availabili1_`.`quantity_ord_max` AS `quantity5_44_1_`, `availabili1_`.`quantity_ord_min` AS `quantity6_44_1_`, `availabili1_`.`status` AS `status7_44_1_`, `availabili1_`.`region` AS `region8_44_1_`, `availabili1_`.`region_variant` AS `region_v9_44_1_`, `availabili1_`.`product_id` AS `product10_44_0__`, `availabili1_`.`product_avail_id` AS `product_1_44_0__`, `prices4_`.`product_price_code` AS `product_2_54_2_`, `prices4_`.`default_price` AS `default_3_54_2_`, `prices4_`.`product_avail_id` AS `product_9_54_2_`, `prices4_`.`product_price_amount` AS `product_4_54_2_`, `prices4_`.`product_price_special_amount` AS `product_5_54_2_`, `prices4_`.`product_price_special_end_date` AS `product_6_54_2_`, `prices4_`.`product_price_special_st_date` AS `product_7_54_2_`, `prices4_`.`product_price_type` AS `product_8_54_2_`, `prices4_`.`product_avail_id` AS `product_9_54_1__`, `prices4_`.`product_price_id` AS `product_1_54_1__`, `descriptio5_`.`date_created` AS `date_cre2_55_3_`, `descriptio5_`.`date_modified` AS `date_mod3_55_3_`, `descriptio5_`.`updt_id` AS `updt_id4_55_3_`, `descriptio5_`.`description` AS `descript5_55_3_`, `descriptio5_`.`language_id` AS `language8_55_3_`, `descriptio5_`.`name` AS `name6_55_3_`, `descriptio5_`.`title` AS `title7_55_3_`, `descriptio5_`.`product_price_id` AS `product_9_55_3_`, `descriptio5_`.`product_price_id` AS `product_9_55_2__`, `descriptio5_`.`description_id` AS `descript1_55_2__`, `descriptio2_`.`date_created` AS `date_cre2_46_4_`, `descriptio2_`.`date_modified` AS `date_mod3_46_4_`, `descriptio2_`.`updt_id` AS `updt_id4_46_4_`, `descriptio2_`.`description` AS `descript5_46_4_`, `descriptio2_`.`language_id` AS `languag14_46_4_`, `descriptio2_`.`name` AS `name6_46_4_`, `descriptio2_`.`title` AS `title7_46_4_`, `descriptio2_`.`meta_description` AS `meta_des8_46_4_`, `descriptio2_`.`meta_keywords` AS `meta_key9_46_4_`, `descriptio2_`.`meta_title` AS `meta_ti10_46_4_`, `descriptio2_`.`product_id` AS `product15_46_4_`, `descriptio2_`.`download_lnk` AS `downloa11_46_4_`, `descriptio2_`.`product_highlight` AS `product12_46_4_`, `descriptio2_`.`sef_url` AS `sef_url13_46_4_`, `descriptio2_`.`product_id` AS `product15_46_3__`, `descriptio2_`.`description_id` AS `descript1_46_3__`, `merchantst3_`.`date_created` AS `date_cre2_27_5_`, `merchantst3_`.`date_modified` AS `date_mod3_27_5_`, `merchantst3_`.`updt_id` AS `updt_id4_27_5_`, `merchantst3_`.`store_code` AS `store_co5_27_5_`, `merchantst3_`.`continueshoppingurl` AS `continue6_27_5_`, `merchantst3_`.`country_id` AS `country23_27_5_`, `merchantst3_`.`currency_id` AS `currenc24_27_5_`, `merchantst3_`.`currency_format_national` AS `currency7_27_5_`, `merchantst3_`.`language_id` AS `languag25_27_5_`, `merchantst3_`.`domain_name` AS `domain_n8_27_5_`, `merchantst3_`.`in_business_since` AS `in_busin9_27_5_`, `merchantst3_`.`invoice_template` AS `invoice10_27_5_`, `merchantst3_`.`seizeunitcode` AS `seizeun11_27_5_`, `merchantst3_`.`store_email` AS `store_e12_27_5_`, `merchantst3_`.`store_logo` AS `store_l13_27_5_`, `merchantst3_`.`store_template` AS `store_t14_27_5_`, `merchantst3_`.`store_address` AS `store_a15_27_5_`, `merchantst3_`.`store_city` AS `store_c16_27_5_`, `merchantst3_`.`store_name` AS `store_n17_27_5_`, `merchantst3_`.`store_phone` AS `store_p18_27_5_`, `merchantst3_`.`store_postal_code` AS `store_p19_27_5_`, `merchantst3_`.`store_state_prov` AS `store_s20_27_5_`, `merchantst3_`.`use_cache` AS `use_cac21_27_5_`, `merchantst3_`.`weightunitcode` AS `weightu22_27_5_`, `merchantst3_`.`zone_id` AS `zone_id26_27_5_`, `category7_`.`date_created` AS `date_cre2_0_6_`, `category7_`.`date_modified` AS `date_mod3_0_6_`, `category7_`.`updt_id` AS `updt_id4_0_6_`, `category7_`.`category_image` AS `category5_0_6_`, `category7_`.`category_status` AS `category6_0_6_`, `category7_`.`code` AS `code7_0_6_`, `category7_`.`depth` AS `depth8_0_6_`, `category7_`.`featured` AS `featured9_0_6_`, `category7_`.`lineage` AS `lineage10_0_6_`, `category7_`.`merchant_id` AS `merchan13_0_6_`, `category7_`.`parent_id` AS `parent_14_0_6_`, `category7_`.`sort_order` AS `sort_or11_0_6_`, `category7_`.`visible` AS `visible12_0_6_`, `categories6_`.`product_id` AS `product_1_45_4__`, `categories6_`.`category_id` AS `category2_45_4__`, `descriptio8_`.`date_created` AS `date_cre2_1_7_`, `descriptio8_`.`date_modified` AS `date_mod3_1_7_`, `descriptio8_`.`updt_id` AS `updt_id4_1_7_`, `descriptio8_`.`description` AS `descript5_1_7_`, `descriptio8_`.`language_id` AS `languag13_1_7_`, `descriptio8_`.`name` AS `name6_1_7_`, `descriptio8_`.`title` AS `title7_1_7_`, `descriptio8_`.`category_id` AS `categor14_1_7_`, `descriptio8_`.`category_highlight` AS `category8_1_7_`, `descriptio8_`.`meta_description` AS `meta_des9_1_7_`, `descriptio8_`.`meta_keywords` AS `meta_ke10_1_7_`, `descriptio8_`.`meta_title` AS `meta_ti11_1_7_`, `descriptio8_`.`sef_url` AS `sef_url12_1_7_`, `descriptio8_`.`category_id` AS `categor14_1_5__`, `descriptio8_`.`description_id` AS `descript1_1_5__`, `images9_`.`default_image` AS `default_2_48_8_`, `images9_`.`image_crop` AS `image_cr3_48_8_`, `images9_`.`image_type` AS `image_ty4_48_8_`, `images9_`.`product_id` AS `product_7_48_8_`, `images9_`.`product_image` AS `product_5_48_8_`, `images9_`.`product_image_url` AS `product_6_48_8_`, `images9_`.`product_id` AS `product_7_48_6__`, `images9_`.`product_image_id` AS `product_1_48_6__`, `attributes10_`.`product_attribute_default` AS `product_2_43_9_`, `attributes10_`.`product_attribute_discounted` AS `product_3_43_9_`, `attributes10_`.`product_attribute_for_disp` AS `product_4_43_9_`, `attributes10_`.`product_attribute_required` AS `product_5_43_9_`, `attributes10_`.`product_id` AS `product10_43_9_`, `attributes10_`.`product_attribute_free` AS `product_6_43_9_`, `attributes10_`.`product_atribute_price` AS `product_7_43_9_`, `attributes10_`.`product_attribute_weight` AS `product_8_43_9_`, `attributes10_`.`option_id` AS `option_11_43_9_`, `attributes10_`.`product_attribute_sort_ord` AS `product_9_43_9_`, `attributes10_`.`option_value_id` AS `option_12_43_9_`, `attributes10_`.`product_id` AS `product10_43_7__`, `attributes10_`.`product_attribute_id` AS `product_1_43_7__`, `productopt11_`.`product_option_code` AS `product_2_50_10_`, `productopt11_`.`merchant_id` AS `merchant6_50_10_`, `productopt11_`.`product_option_sort_ord` AS `product_3_50_10_`, `productopt11_`.`product_option_type` AS `product_4_50_10_`, `productopt11_`.`product_option_read` AS `product_5_50_10_`, `descriptio12_`.`date_created` AS `date_cre2_51_11_`, `descriptio12_`.`date_modified` AS `date_mod3_51_11_`, `descriptio12_`.`updt_id` AS `updt_id4_51_11_`, `descriptio12_`.`description` AS `descript5_51_11_`, `descriptio12_`.`language_id` AS `language9_51_11_`, `descriptio12_`.`name` AS `name6_51_11_`, `descriptio12_`.`title` AS `title7_51_11_`, `descriptio12_`.`product_option_id` AS `product10_51_11_`, `descriptio12_`.`product_option_comment` AS `product_8_51_11_`, `descriptio12_`.`product_option_id` AS `product10_51_8__`, `descriptio12_`.`description_id` AS `descript1_51_8__`, `productopt13_`.`product_option_val_code` AS `product_2_52_12_`, `productopt13_`.`merchant_id` AS `merchant6_52_12_`, `productopt13_`.`product_opt_for_disp` AS `product_3_52_12_`, `productopt13_`.`product_opt_val_image` AS `product_4_52_12_`, `productopt13_`.`product_opt_val_sort_ord` AS `product_5_52_12_`, `descriptio14_`.`date_created` AS `date_cre2_53_13_`, `descriptio14_`.`date_modified` AS `date_mod3_53_13_`, `descriptio14_`.`updt_id` AS `updt_id4_53_13_`, `descriptio14_`.`description` AS `descript5_53_13_`, `descriptio14_`.`language_id` AS `language8_53_13_`, `descriptio14_`.`name` AS `name6_53_13_`, `descriptio14_`.`title` AS `title7_53_13_`, `descriptio14_`.`product_option_value_id` AS `product_9_53_13_`, `descriptio14_`.`product_option_value_id` AS `product_9_53_9__`, `descriptio14_`.`description_id` AS `descript1_53_9__`, `relationsh15_`.`active` AS `active2_56_14_`, `relationsh15_`.`code` AS `code3_56_14_`, `relationsh15_`.`product_id` AS `product_4_56_14_`, `relationsh15_`.`related_product_id` AS `related_5_56_14_`, `relationsh15_`.`merchant_id` AS `merchant6_56_14_`, `relationsh15_`.`product_id` AS `product_4_56_10__`, `relationsh15_`.`product_relationship_id` AS `product_1_56_10__`, `manufactur16_`.`date_created` AS `date_cre2_22_15_`, `manufactur16_`.`date_modified` AS `date_mod3_22_15_`, `manufactur16_`.`updt_id` AS `updt_id4_22_15_`, `manufactur16_`.`code` AS `code5_22_15_`, `manufactur16_`.`manufacturer_image` AS `manufact6_22_15_`, `manufactur16_`.`merchant_id` AS `merchant8_22_15_`, `manufactur16_`.`sort_order` AS `sort_ord7_22_15_`, `descriptio17_`.`date_created` AS `date_cre2_23_16_`, `descriptio17_`.`date_modified` AS `date_mod3_23_16_`, `descriptio17_`.`updt_id` AS `updt_id4_23_16_`, `descriptio17_`.`description` AS `descript5_23_16_`, `descriptio17_`.`language_id` AS `languag11_23_16_`, `descriptio17_`.`name` AS `name6_23_16_`, `descriptio17_`.`title` AS `title7_23_16_`, `descriptio17_`.`date_last_click` AS `date_las8_23_16_`, `descriptio17_`.`manufacturer_id` AS `manufac12_23_16_`, `descriptio17_`.`manufacturers_url` AS `manufact9_23_16_`, `descriptio17_`.`url_clicked` AS `url_cli10_23_16_`, `descriptio17_`.`manufacturer_id` AS `manufac12_23_11__`, `descriptio17_`.`description_id` AS `descript1_23_11__`, `producttyp18_`.`prd_type_add_to_cart` AS `prd_type2_59_17_`, `producttyp18_`.`date_created` AS `date_cre3_59_17_`, `producttyp18_`.`date_modified` AS `date_mod4_59_17_`, `producttyp18_`.`updt_id` AS `updt_id5_59_17_`, `producttyp18_`.`prd_type_code` AS `prd_type6_59_17_`, `taxclass19_`.`tax_class_code` AS `tax_clas2_69_18_`, `taxclass19_`.`merchant_id` AS `merchant4_69_18_`, `taxclass19_`.`tax_class_title` AS `tax_clas3_69_18_`, `customer20_`.`customer_anonymous` AS `customer2_7_19_`, `customer20_`.`date_created` AS `date_cre3_7_19_`, `customer20_`.`date_modified` AS `date_mod4_7_19_`, `customer20_`.`updt_id` AS `updt_id5_7_19_`, `customer20_`.`billing_street_address` AS `billing_6_7_19_`, `customer20_`.`billing_city` AS `billing_7_7_19_`, `customer20_`.`billing_company` AS `billing_8_7_19_`, `customer20_`.`billing_country_id` AS `billing33_7_19_`, `customer20_`.`billing_first_name` AS `billing_9_7_19_`, `customer20_`.`billing_last_name` AS `billing10_7_19_`, `customer20_`.`latitude` AS `latitud11_7_19_`, `customer20_`.`longitude` AS `longitu12_7_19_`, `customer20_`.`billing_postcode` AS `billing13_7_19_`, `customer20_`.`billing_state` AS `billing14_7_19_`, `customer20_`.`billing_telephone` AS `billing15_7_19_`, `customer20_`.`billing_zone_id` AS `billing34_7_19_`, `customer20_`.`customer_company` AS `custome16_7_19_`, `customer20_`.`review_avg` AS `review_17_7_19_`, `customer20_`.`review_count` AS `review_18_7_19_`, `customer20_`.`customer_dob` AS `custome19_7_19_`, `customer20_`.`language_id` AS `languag35_7_19_`, `customer20_`.`delivery_street_address` AS `deliver20_7_19_`, `customer20_`.`delivery_city` AS `deliver21_7_19_`, `customer20_`.`delivery_company` AS `deliver22_7_19_`, `customer20_`.`delivery_country_id` AS `deliver36_7_19_`, `customer20_`.`delivery_first_name` AS `deliver23_7_19_`, `customer20_`.`delivery_last_name` AS `deliver24_7_19_`, `customer20_`.`delivery_postcode` AS `deliver25_7_19_`, `customer20_`.`delivery_state` AS `deliver26_7_19_`, `customer20_`.`delivery_telephone` AS `deliver27_7_19_`, `customer20_`.`delivery_zone_id` AS `deliver37_7_19_`, `customer20_`.`customer_email_address` AS `custome28_7_19_`, `customer20_`.`customer_gender` AS `custome29_7_19_`, `customer20_`.`merchant_id` AS `merchan38_7_19_`, `customer20_`.`customer_nick` AS `custome30_7_19_`, `customer20_`.`customer_password` AS `custome31_7_19_`, `customer20_`.`provider` AS `provide32_7_19_` FROM `product` AS `product0_` INNER JOIN `customer` AS `customer20_` ON `product0_`.`customer_id` = `customer20_`.`customer_id` INNER JOIN `merchant_store` AS `merchantst3_` ON `product0_`.`merchant_id` = `merchantst3_`.`merchant_id` INNER JOIN `product_availability` AS `availabili1_` ON `product0_`.`product_id` = `availabili1_`.`product_id` INNER JOIN `product_description` AS `descriptio2_` ON `product0_`.`product_id` = `descriptio2_`.`product_id` INNER JOIN `product_type` AS `producttyp18_` ON `product0_`.`product_type_id` = `producttyp18_`.`product_type_id` INNER JOIN `tax_class` AS `taxclass19_` ON `product0_`.`tax_class_id` = `taxclass19_`.`tax_class_id` LEFT JOIN `manufacturer` AS `manufactur16_` ON `product0_`.`manufacturer_id` = `manufactur16_`.`manufacturer_id` LEFT JOIN `product_attribute` AS `attributes10_` ON `product0_`.`product_id` = `attributes10_`.`product_id` LEFT JOIN `product_category` AS `categories6_` ON `product0_`.`product_id` = `categories6_`.`product_id` LEFT JOIN `product_image` AS `images9_` ON `product0_`.`product_id` = `images9_`.`product_id` LEFT JOIN `product_relationship` AS `relationsh15_` ON `product0_`.`product_id` = `relationsh15_`.`product_id` LEFT JOIN `product_price` AS `prices4_` ON `availabili1_`.`product_avail_id` = `prices4_`.`product_avail_id` LEFT JOIN `manufacturer_description` AS `descriptio17_` ON `manufactur16_`.`manufacturer_id` = `descriptio17_`.`manufacturer_id` LEFT JOIN `product_option` AS `productopt11_` ON `attributes10_`.`option_id` = `productopt11_`.`product_option_id` LEFT JOIN `product_option_value` AS `productopt13_` ON `attributes10_`.`option_value_id` = `productopt13_`.`product_option_value_id` LEFT JOIN `category` AS `category7_` ON `categories6_`.`category_id` = `category7_`.`category_id` INNER JOIN `product_price_description` AS `descriptio5_` ON `prices4_`.`product_price_id` = `descriptio5_`.`product_price_id` LEFT JOIN `product_option_desc` AS `descriptio12_` ON `productopt11_`.`product_option_id` = `descriptio12_`.`product_option_id` LEFT JOIN `product_option_value_description` AS `descriptio14_` ON `productopt13_`.`product_option_value_id` = `descriptio14_`.`product_option_value_id` LEFT JOIN `category_description` AS `descriptio8_` ON `category7_`.`category_id` = `descriptio8_`.`category_id` WHERE `product0_`.`sku` = 'qwer123' AND `descriptio2_`.`language_id` = 1 AND `descriptio5_`.`language_id` = 1",
        };
    doTest(appName, stmtId, expected);
  }

  //  @Test // 128
  void testShopizer39() {
    final String appName = "shopizer";
    final int stmtId = 39;
    final String[] expected =
        new String[] {
          "SELECT `productrel0_`.`product_relationship_id` AS `product_1_56_0_`, `product1_`.`product_id` AS `product_1_42_1_`, `product2_`.`product_id` AS `product_1_42_2_`, `attributes3_`.`product_attribute_id` AS `product_1_43_3_`, `productopt4_`.`product_option_id` AS `product_1_50_4_`, `descriptio5_`.`description_id` AS `descript1_51_5_`, `productopt6_`.`product_option_value_id` AS `product_1_52_6_`, `descriptio7_`.`description_id` AS `descript1_53_7_`, `category9_`.`category_id` AS `category1_0_8_`, `descriptio10_`.`description_id` AS `descript1_1_9_`, `descriptio11_`.`description_id` AS `descript1_46_10_`, `customer12_`.`customer_id` AS `customer1_7_11_`, `images13_`.`product_image_id` AS `product_1_48_12_`, `merchantst14_`.`merchant_id` AS `merchant1_27_13_`, `currency15_`.`currency_id` AS `currency1_6_14_`, `availabili16_`.`product_avail_id` AS `product_1_44_15_`, `prices19_`.`product_price_id` AS `product_1_54_16_`, `descriptio20_`.`description_id` AS `descript1_55_17_`, `manufactur17_`.`manufacturer_id` AS `manufact1_22_18_`, `descriptio18_`.`description_id` AS `descript1_23_19_`, `productrel0_`.`active` AS `active2_56_0_`, `productrel0_`.`code` AS `code3_56_0_`, `productrel0_`.`product_id` AS `product_4_56_0_`, `productrel0_`.`related_product_id` AS `related_5_56_0_`, `productrel0_`.`merchant_id` AS `merchant6_56_0_`, `product1_`.`date_created` AS `date_cre2_42_1_`, `product1_`.`date_modified` AS `date_mod3_42_1_`, `product1_`.`updt_id` AS `updt_id4_42_1_`, `product1_`.`available` AS `availabl5_42_1_`, `product1_`.`cond` AS `cond6_42_1_`, `product1_`.`date_available` AS `date_ava7_42_1_`, `product1_`.`manufacturer_id` AS `manufac25_42_1_`, `product1_`.`merchant_id` AS `merchan26_42_1_`, `product1_`.`customer_id` AS `custome27_42_1_`, `product1_`.`preorder` AS `preorder8_42_1_`, `product1_`.`product_height` AS `product_9_42_1_`, `product1_`.`product_free` AS `product10_42_1_`, `product1_`.`product_length` AS `product11_42_1_`, `product1_`.`quantity_ordered` AS `quantit12_42_1_`, `product1_`.`review_avg` AS `review_13_42_1_`, `product1_`.`review_count` AS `review_14_42_1_`, `product1_`.`product_ship` AS `product15_42_1_`, `product1_`.`product_virtual` AS `product16_42_1_`, `product1_`.`product_weight` AS `product17_42_1_`, `product1_`.`product_width` AS `product18_42_1_`, `product1_`.`ref_sku` AS `ref_sku19_42_1_`, `product1_`.`rental_duration` AS `rental_20_42_1_`, `product1_`.`rental_period` AS `rental_21_42_1_`, `product1_`.`rental_status` AS `rental_22_42_1_`, `product1_`.`sku` AS `sku23_42_1_`, `product1_`.`sort_order` AS `sort_or24_42_1_`, `product1_`.`tax_class_id` AS `tax_cla28_42_1_`, `product1_`.`product_type_id` AS `product29_42_1_`, `product2_`.`date_created` AS `date_cre2_42_2_`, `product2_`.`date_modified` AS `date_mod3_42_2_`, `product2_`.`updt_id` AS `updt_id4_42_2_`, `product2_`.`available` AS `availabl5_42_2_`, `product2_`.`cond` AS `cond6_42_2_`, `product2_`.`date_available` AS `date_ava7_42_2_`, `product2_`.`manufacturer_id` AS `manufac25_42_2_`, `product2_`.`merchant_id` AS `merchan26_42_2_`, `product2_`.`customer_id` AS `custome27_42_2_`, `product2_`.`preorder` AS `preorder8_42_2_`, `product2_`.`product_height` AS `product_9_42_2_`, `product2_`.`product_free` AS `product10_42_2_`, `product2_`.`product_length` AS `product11_42_2_`, `product2_`.`quantity_ordered` AS `quantit12_42_2_`, `product2_`.`review_avg` AS `review_13_42_2_`, `product2_`.`review_count` AS `review_14_42_2_`, `product2_`.`product_ship` AS `product15_42_2_`, `product2_`.`product_virtual` AS `product16_42_2_`, `product2_`.`product_weight` AS `product17_42_2_`, `product2_`.`product_width` AS `product18_42_2_`, `product2_`.`ref_sku` AS `ref_sku19_42_2_`, `product2_`.`rental_duration` AS `rental_20_42_2_`, `product2_`.`rental_period` AS `rental_21_42_2_`, `product2_`.`rental_status` AS `rental_22_42_2_`, `product2_`.`sku` AS `sku23_42_2_`, `product2_`.`sort_order` AS `sort_or24_42_2_`, `product2_`.`tax_class_id` AS `tax_cla28_42_2_`, `product2_`.`product_type_id` AS `product29_42_2_`, `attributes3_`.`product_attribute_default` AS `product_2_43_3_`, `attributes3_`.`product_attribute_discounted` AS `product_3_43_3_`, `attributes3_`.`product_attribute_for_disp` AS `product_4_43_3_`, `attributes3_`.`product_attribute_required` AS `product_5_43_3_`, `attributes3_`.`product_id` AS `product10_43_3_`, `attributes3_`.`product_attribute_free` AS `product_6_43_3_`, `attributes3_`.`product_atribute_price` AS `product_7_43_3_`, `attributes3_`.`product_attribute_weight` AS `product_8_43_3_`, `attributes3_`.`option_id` AS `option_11_43_3_`, `attributes3_`.`product_attribute_sort_ord` AS `product_9_43_3_`, `attributes3_`.`option_value_id` AS `option_12_43_3_`, `attributes3_`.`product_id` AS `product10_43_0__`, `attributes3_`.`product_attribute_id` AS `product_1_43_0__`, `productopt4_`.`product_option_code` AS `product_2_50_4_`, `productopt4_`.`merchant_id` AS `merchant6_50_4_`, `productopt4_`.`product_option_sort_ord` AS `product_3_50_4_`, `productopt4_`.`product_option_type` AS `product_4_50_4_`, `productopt4_`.`product_option_read` AS `product_5_50_4_`, `descriptio5_`.`date_created` AS `date_cre2_51_5_`, `descriptio5_`.`date_modified` AS `date_mod3_51_5_`, `descriptio5_`.`updt_id` AS `updt_id4_51_5_`, `descriptio5_`.`description` AS `descript5_51_5_`, `descriptio5_`.`language_id` AS `language9_51_5_`, `descriptio5_`.`name` AS `name6_51_5_`, `descriptio5_`.`title` AS `title7_51_5_`, `descriptio5_`.`product_option_id` AS `product10_51_5_`, `descriptio5_`.`product_option_comment` AS `product_8_51_5_`, `descriptio5_`.`product_option_id` AS `product10_51_1__`, `descriptio5_`.`description_id` AS `descript1_51_1__`, `productopt6_`.`product_option_val_code` AS `product_2_52_6_`, `productopt6_`.`merchant_id` AS `merchant6_52_6_`, `productopt6_`.`product_opt_for_disp` AS `product_3_52_6_`, `productopt6_`.`product_opt_val_image` AS `product_4_52_6_`, `productopt6_`.`product_opt_val_sort_ord` AS `product_5_52_6_`, `descriptio7_`.`date_created` AS `date_cre2_53_7_`, `descriptio7_`.`date_modified` AS `date_mod3_53_7_`, `descriptio7_`.`updt_id` AS `updt_id4_53_7_`, `descriptio7_`.`description` AS `descript5_53_7_`, `descriptio7_`.`language_id` AS `language8_53_7_`, `descriptio7_`.`name` AS `name6_53_7_`, `descriptio7_`.`title` AS `title7_53_7_`, `descriptio7_`.`product_option_value_id` AS `product_9_53_7_`, `descriptio7_`.`product_option_value_id` AS `product_9_53_2__`, `descriptio7_`.`description_id` AS `descript1_53_2__`, `category9_`.`date_created` AS `date_cre2_0_8_`, `category9_`.`date_modified` AS `date_mod3_0_8_`, `category9_`.`updt_id` AS `updt_id4_0_8_`, `category9_`.`category_image` AS `category5_0_8_`, `category9_`.`category_status` AS `category6_0_8_`, `category9_`.`code` AS `code7_0_8_`, `category9_`.`depth` AS `depth8_0_8_`, `category9_`.`featured` AS `featured9_0_8_`, `category9_`.`lineage` AS `lineage10_0_8_`, `category9_`.`merchant_id` AS `merchan13_0_8_`, `category9_`.`parent_id` AS `parent_14_0_8_`, `category9_`.`sort_order` AS `sort_or11_0_8_`, `category9_`.`visible` AS `visible12_0_8_`, `categories8_`.`product_id` AS `product_1_45_3__`, `categories8_`.`category_id` AS `category2_45_3__`, `descriptio10_`.`date_created` AS `date_cre2_1_9_`, `descriptio10_`.`date_modified` AS `date_mod3_1_9_`, `descriptio10_`.`updt_id` AS `updt_id4_1_9_`, `descriptio10_`.`description` AS `descript5_1_9_`, `descriptio10_`.`language_id` AS `languag13_1_9_`, `descriptio10_`.`name` AS `name6_1_9_`, `descriptio10_`.`title` AS `title7_1_9_`, `descriptio10_`.`category_id` AS `categor14_1_9_`, `descriptio10_`.`category_highlight` AS `category8_1_9_`, `descriptio10_`.`meta_description` AS `meta_des9_1_9_`, `descriptio10_`.`meta_keywords` AS `meta_ke10_1_9_`, `descriptio10_`.`meta_title` AS `meta_ti11_1_9_`, `descriptio10_`.`sef_url` AS `sef_url12_1_9_`, `descriptio10_`.`category_id` AS `categor14_1_4__`, `descriptio10_`.`description_id` AS `descript1_1_4__`, `descriptio11_`.`date_created` AS `date_cre2_46_10_`, `descriptio11_`.`date_modified` AS `date_mod3_46_10_`, `descriptio11_`.`updt_id` AS `updt_id4_46_10_`, `descriptio11_`.`description` AS `descript5_46_10_`, `descriptio11_`.`language_id` AS `languag14_46_10_`, `descriptio11_`.`name` AS `name6_46_10_`, `descriptio11_`.`title` AS `title7_46_10_`, `descriptio11_`.`meta_description` AS `meta_des8_46_10_`, `descriptio11_`.`meta_keywords` AS `meta_key9_46_10_`, `descriptio11_`.`meta_title` AS `meta_ti10_46_10_`, `descriptio11_`.`product_id` AS `product15_46_10_`, `descriptio11_`.`download_lnk` AS `downloa11_46_10_`, `descriptio11_`.`product_highlight` AS `product12_46_10_`, `descriptio11_`.`sef_url` AS `sef_url13_46_10_`, `descriptio11_`.`product_id` AS `product15_46_5__`, `descriptio11_`.`description_id` AS `descript1_46_5__`, `customer12_`.`customer_anonymous` AS `customer2_7_11_`, `customer12_`.`date_created` AS `date_cre3_7_11_`, `customer12_`.`date_modified` AS `date_mod4_7_11_`, `customer12_`.`updt_id` AS `updt_id5_7_11_`, `customer12_`.`billing_street_address` AS `billing_6_7_11_`, `customer12_`.`billing_city` AS `billing_7_7_11_`, `customer12_`.`billing_company` AS `billing_8_7_11_`, `customer12_`.`billing_country_id` AS `billing33_7_11_`, `customer12_`.`billing_first_name` AS `billing_9_7_11_`, `customer12_`.`billing_last_name` AS `billing10_7_11_`, `customer12_`.`latitude` AS `latitud11_7_11_`, `customer12_`.`longitude` AS `longitu12_7_11_`, `customer12_`.`billing_postcode` AS `billing13_7_11_`, `customer12_`.`billing_state` AS `billing14_7_11_`, `customer12_`.`billing_telephone` AS `billing15_7_11_`, `customer12_`.`billing_zone_id` AS `billing34_7_11_`, `customer12_`.`customer_company` AS `custome16_7_11_`, `customer12_`.`review_avg` AS `review_17_7_11_`, `customer12_`.`review_count` AS `review_18_7_11_`, `customer12_`.`customer_dob` AS `custome19_7_11_`, `customer12_`.`language_id` AS `languag35_7_11_`, `customer12_`.`delivery_street_address` AS `deliver20_7_11_`, `customer12_`.`delivery_city` AS `deliver21_7_11_`, `customer12_`.`delivery_company` AS `deliver22_7_11_`, `customer12_`.`delivery_country_id` AS `deliver36_7_11_`, `customer12_`.`delivery_first_name` AS `deliver23_7_11_`, `customer12_`.`delivery_last_name` AS `deliver24_7_11_`, `customer12_`.`delivery_postcode` AS `deliver25_7_11_`, `customer12_`.`delivery_state` AS `deliver26_7_11_`, `customer12_`.`delivery_telephone` AS `deliver27_7_11_`, `customer12_`.`delivery_zone_id` AS `deliver37_7_11_`, `customer12_`.`customer_email_address` AS `custome28_7_11_`, `customer12_`.`customer_gender` AS `custome29_7_11_`, `customer12_`.`merchant_id` AS `merchan38_7_11_`, `customer12_`.`customer_nick` AS `custome30_7_11_`, `customer12_`.`customer_password` AS `custome31_7_11_`, `customer12_`.`provider` AS `provide32_7_11_`, `images13_`.`default_image` AS `default_2_48_12_`, `images13_`.`image_crop` AS `image_cr3_48_12_`, `images13_`.`image_type` AS `image_ty4_48_12_`, `images13_`.`product_id` AS `product_7_48_12_`, `images13_`.`product_image` AS `product_5_48_12_`, `images13_`.`product_image_url` AS `product_6_48_12_`, `images13_`.`product_id` AS `product_7_48_6__`, `images13_`.`product_image_id` AS `product_1_48_6__`, `merchantst14_`.`date_created` AS `date_cre2_27_13_`, `merchantst14_`.`date_modified` AS `date_mod3_27_13_`, `merchantst14_`.`updt_id` AS `updt_id4_27_13_`, `merchantst14_`.`store_code` AS `store_co5_27_13_`, `merchantst14_`.`continueshoppingurl` AS `continue6_27_13_`, `merchantst14_`.`country_id` AS `country23_27_13_`, `merchantst14_`.`currency_id` AS `currenc24_27_13_`, `merchantst14_`.`currency_format_national` AS `currency7_27_13_`, `merchantst14_`.`language_id` AS `languag25_27_13_`, `merchantst14_`.`domain_name` AS `domain_n8_27_13_`, `merchantst14_`.`in_business_since` AS `in_busin9_27_13_`, `merchantst14_`.`invoice_template` AS `invoice10_27_13_`, `merchantst14_`.`seizeunitcode` AS `seizeun11_27_13_`, `merchantst14_`.`store_email` AS `store_e12_27_13_`, `merchantst14_`.`store_logo` AS `store_l13_27_13_`, `merchantst14_`.`store_template` AS `store_t14_27_13_`, `merchantst14_`.`store_address` AS `store_a15_27_13_`, `merchantst14_`.`store_city` AS `store_c16_27_13_`, `merchantst14_`.`store_name` AS `store_n17_27_13_`, `merchantst14_`.`store_phone` AS `store_p18_27_13_`, `merchantst14_`.`store_postal_code` AS `store_p19_27_13_`, `merchantst14_`.`store_state_prov` AS `store_s20_27_13_`, `merchantst14_`.`use_cache` AS `use_cac21_27_13_`, `merchantst14_`.`weightunitcode` AS `weightu22_27_13_`, `merchantst14_`.`zone_id` AS `zone_id26_27_13_`, `currency15_`.`currency_code` AS `currency2_6_14_`, `currency15_`.`currency_currency_code` AS `currency3_6_14_`, `currency15_`.`currency_name` AS `currency4_6_14_`, `currency15_`.`currency_supported` AS `currency5_6_14_`, `availabili16_`.`product_id` AS `product10_44_15_`, `availabili16_`.`date_available` AS `date_ava2_44_15_`, `availabili16_`.`free_shipping` AS `free_shi3_44_15_`, `availabili16_`.`quantity` AS `quantity4_44_15_`, `availabili16_`.`quantity_ord_max` AS `quantity5_44_15_`, `availabili16_`.`quantity_ord_min` AS `quantity6_44_15_`, `availabili16_`.`status` AS `status7_44_15_`, `availabili16_`.`region` AS `region8_44_15_`, `availabili16_`.`region_variant` AS `region_v9_44_15_`, `availabili16_`.`product_id` AS `product10_44_7__`, `availabili16_`.`product_avail_id` AS `product_1_44_7__`, `prices19_`.`product_price_code` AS `product_2_54_16_`, `prices19_`.`default_price` AS `default_3_54_16_`, `prices19_`.`product_avail_id` AS `product_9_54_16_`, `prices19_`.`product_price_amount` AS `product_4_54_16_`, `prices19_`.`product_price_special_amount` AS `product_5_54_16_`, `prices19_`.`product_price_special_end_date` AS `product_6_54_16_`, `prices19_`.`product_price_special_st_date` AS `product_7_54_16_`, `prices19_`.`product_price_type` AS `product_8_54_16_`, `prices19_`.`product_avail_id` AS `product_9_54_8__`, `prices19_`.`product_price_id` AS `product_1_54_8__`, `descriptio20_`.`date_created` AS `date_cre2_55_17_`, `descriptio20_`.`date_modified` AS `date_mod3_55_17_`, `descriptio20_`.`updt_id` AS `updt_id4_55_17_`, `descriptio20_`.`description` AS `descript5_55_17_`, `descriptio20_`.`language_id` AS `language8_55_17_`, `descriptio20_`.`name` AS `name6_55_17_`, `descriptio20_`.`title` AS `title7_55_17_`, `descriptio20_`.`product_price_id` AS `product_9_55_17_`, `descriptio20_`.`product_price_id` AS `product_9_55_9__`, `descriptio20_`.`description_id` AS `descript1_55_9__`, `manufactur17_`.`date_created` AS `date_cre2_22_18_`, `manufactur17_`.`date_modified` AS `date_mod3_22_18_`, `manufactur17_`.`updt_id` AS `updt_id4_22_18_`, `manufactur17_`.`code` AS `code5_22_18_`, `manufactur17_`.`manufacturer_image` AS `manufact6_22_18_`, `manufactur17_`.`merchant_id` AS `merchant8_22_18_`, `manufactur17_`.`sort_order` AS `sort_ord7_22_18_`, `descriptio18_`.`date_created` AS `date_cre2_23_19_`, `descriptio18_`.`date_modified` AS `date_mod3_23_19_`, `descriptio18_`.`updt_id` AS `updt_id4_23_19_`, `descriptio18_`.`description` AS `descript5_23_19_`, `descriptio18_`.`language_id` AS `languag11_23_19_`, `descriptio18_`.`name` AS `name6_23_19_`, `descriptio18_`.`title` AS `title7_23_19_`, `descriptio18_`.`date_last_click` AS `date_las8_23_19_`, `descriptio18_`.`manufacturer_id` AS `manufac12_23_19_`, `descriptio18_`.`manufacturers_url` AS `manufact9_23_19_`, `descriptio18_`.`url_clicked` AS `url_cli10_23_19_`, `descriptio18_`.`manufacturer_id` AS `manufac12_23_10__`, `descriptio18_`.`description_id` AS `descript1_23_10__` FROM `product_relationship` AS `productrel0_` INNER JOIN `product` AS `product1_` ON `productrel0_`.`product_id` = `product1_`.`product_id` INNER JOIN `product` AS `product2_` ON `productrel0_`.`related_product_id` = `product2_`.`product_id` INNER JOIN `customer` AS `customer12_` ON `product2_`.`customer_id` = `customer12_`.`customer_id` INNER JOIN `product_description` AS `descriptio11_` ON `product2_`.`product_id` = `descriptio11_`.`product_id` LEFT JOIN `manufacturer` AS `manufactur17_` ON `product2_`.`manufacturer_id` = `manufactur17_`.`manufacturer_id` LEFT JOIN `merchant_store` AS `merchantst14_` ON `product2_`.`merchant_id` = `merchantst14_`.`merchant_id` LEFT JOIN `product_attribute` AS `attributes3_` ON `product2_`.`product_id` = `attributes3_`.`product_id` LEFT JOIN `product_availability` AS `availabili16_` ON `product2_`.`product_id` = `availabili16_`.`product_id` LEFT JOIN `product_category` AS `categories8_` ON `product2_`.`product_id` = `categories8_`.`product_id` LEFT JOIN `product_image` AS `images13_` ON `product2_`.`product_id` = `images13_`.`product_id` LEFT JOIN `manufacturer_description` AS `descriptio18_` ON `manufactur17_`.`manufacturer_id` = `descriptio18_`.`manufacturer_id` INNER JOIN `currency` AS `currency15_` ON `merchantst14_`.`currency_id` = `currency15_`.`currency_id` LEFT JOIN `product_option` AS `productopt4_` ON `attributes3_`.`option_id` = `productopt4_`.`product_option_id` LEFT JOIN `product_option_value` AS `productopt6_` ON `attributes3_`.`option_value_id` = `productopt6_`.`product_option_value_id` LEFT JOIN `product_price` AS `prices19_` ON `availabili16_`.`product_avail_id` = `prices19_`.`product_avail_id` LEFT JOIN `category` AS `category9_` ON `categories8_`.`category_id` = `category9_`.`category_id` LEFT JOIN `product_option_desc` AS `descriptio5_` ON `productopt4_`.`product_option_id` = `descriptio5_`.`product_option_id` LEFT JOIN `product_option_value_description` AS `descriptio7_` ON `productopt6_`.`product_option_value_id` = `descriptio7_`.`product_option_value_id` LEFT JOIN `product_price_description` AS `descriptio20_` ON `prices19_`.`product_price_id` = `descriptio20_`.`product_price_id` LEFT JOIN `category_description` AS `descriptio10_` ON `category9_`.`category_id` = `descriptio10_`.`category_id` WHERE `productrel0_`.`code` = 'FEATURED_ITEM' AND `product2_`.`available` = 1 AND `productrel0_`.`merchant_id` = 1 AND `descriptio11_`.`language_id` = 1",
        };
    doTest(appName, stmtId, expected);
  }

  //  @Test // 131
  void testShopizer57() {
    final String appName = "shopizer";
    final int stmtId = 57;
    final String[] expected =
        new String[] {
          "SELECT * FROM `product` AS `product0_` INNER JOIN `customer` AS `customer13_` ON `product0_`.`customer_id` = `customer13_`.`customer_id` INNER JOIN `merchant_store` AS `merchantst1_` ON `product0_`.`merchant_id` = `merchantst1_`.`merchant_id` INNER JOIN `product_availability` AS `availabili2_` ON `product0_`.`product_id` = `availabili2_`.`product_id` INNER JOIN `product_description` AS `descriptio4_` ON `product0_`.`product_id` = `descriptio4_`.`product_id` INNER JOIN `product_type` AS `producttyp11_` ON `product0_`.`product_type_id` = `producttyp11_`.`product_type_id` INNER JOIN `tax_class` AS `taxclass12_` ON `product0_`.`tax_class_id` = `taxclass12_`.`tax_class_id` LEFT JOIN `manufacturer` AS `manufactur9_` ON `product0_`.`manufacturer_id` = `manufactur9_`.`manufacturer_id` LEFT JOIN `product_attribute` AS `attributes14_` ON `product0_`.`product_id` = `attributes14_`.`product_id` LEFT JOIN `product_category` AS `categories5_` ON `product0_`.`product_id` = `categories5_`.`product_id` LEFT JOIN `product_image` AS `images8_` ON `product0_`.`product_id` = `images8_`.`product_id` LEFT JOIN `product_relationship` AS `relationsh19_` ON `product0_`.`product_id` = `relationsh19_`.`product_id` LEFT JOIN `product_price` AS `prices3_` ON `availabili2_`.`product_avail_id` = `prices3_`.`product_avail_id` LEFT JOIN `manufacturer_description` AS `descriptio10_` ON `manufactur9_`.`manufacturer_id` = `descriptio10_`.`manufacturer_id` LEFT JOIN `product_option` AS `productopt15_` ON `attributes14_`.`option_id` = `productopt15_`.`product_option_id` LEFT JOIN `product_option_value` AS `productopt17_` ON `attributes14_`.`option_value_id` = `productopt17_`.`product_option_value_id` LEFT JOIN `category` AS `category6_` ON `categories5_`.`category_id` = `category6_`.`category_id` LEFT JOIN `product_option_desc` AS `descriptio16_` ON `productopt15_`.`product_option_id` = `descriptio16_`.`product_option_id` LEFT JOIN `product_option_value_description` AS `descriptio18_` ON `productopt17_`.`product_option_value_id` = `descriptio18_`.`product_option_value_id` LEFT JOIN `category_description` AS `descriptio7_` ON `category6_`.`category_id` = `descriptio7_`.`category_id` WHERE `merchantst1_`.`merchant_id` = 1 AND `descriptio4_`.`language_id` = 1 ORDER BY `sort_or24_42_0_` ASC",
        };
    doTest(appName, stmtId, expected);
  }

  //  @Test // 133
  void testShopizer68() {
    final String appName = "shopizer";
    final int stmtId = 68;
    final String[] expected =
        new String[] {
          "SELECT `productrel0_`.`product_relationship_id` AS `product_1_56_0_`, `product1_`.`product_id` AS `product_1_42_1_`, `product2_`.`product_id` AS `product_1_42_2_`, `descriptio3_`.`description_id` AS `descript1_46_3_`, `productrel0_`.`active` AS `active2_56_0_`, `productrel0_`.`code` AS `code3_56_0_`, `productrel0_`.`product_id` AS `product_4_56_0_`, `productrel0_`.`related_product_id` AS `related_5_56_0_`, `productrel0_`.`merchant_id` AS `merchant6_56_0_`, `product1_`.`date_created` AS `date_cre2_42_1_`, `product1_`.`date_modified` AS `date_mod3_42_1_`, `product1_`.`updt_id` AS `updt_id4_42_1_`, `product1_`.`available` AS `availabl5_42_1_`, `product1_`.`cond` AS `cond6_42_1_`, `product1_`.`date_available` AS `date_ava7_42_1_`, `product1_`.`manufacturer_id` AS `manufac25_42_1_`, `product1_`.`merchant_id` AS `merchan26_42_1_`, `product1_`.`customer_id` AS `custome27_42_1_`, `product1_`.`preorder` AS `preorder8_42_1_`, `product1_`.`product_height` AS `product_9_42_1_`, `product1_`.`product_free` AS `product10_42_1_`, `product1_`.`product_length` AS `product11_42_1_`, `product1_`.`quantity_ordered` AS `quantit12_42_1_`, `product1_`.`review_avg` AS `review_13_42_1_`, `product1_`.`review_count` AS `review_14_42_1_`, `product1_`.`product_ship` AS `product15_42_1_`, `product1_`.`product_virtual` AS `product16_42_1_`, `product1_`.`product_weight` AS `product17_42_1_`, `product1_`.`product_width` AS `product18_42_1_`, `product1_`.`ref_sku` AS `ref_sku19_42_1_`, `product1_`.`rental_duration` AS `rental_20_42_1_`, `product1_`.`rental_period` AS `rental_21_42_1_`, `product1_`.`rental_status` AS `rental_22_42_1_`, `product1_`.`sku` AS `sku23_42_1_`, `product1_`.`sort_order` AS `sort_or24_42_1_`, `product1_`.`tax_class_id` AS `tax_cla28_42_1_`, `product1_`.`product_type_id` AS `product29_42_1_`, `product2_`.`date_created` AS `date_cre2_42_2_`, `product2_`.`date_modified` AS `date_mod3_42_2_`, `product2_`.`updt_id` AS `updt_id4_42_2_`, `product2_`.`available` AS `availabl5_42_2_`, `product2_`.`cond` AS `cond6_42_2_`, `product2_`.`date_available` AS `date_ava7_42_2_`, `product2_`.`manufacturer_id` AS `manufac25_42_2_`, `product2_`.`merchant_id` AS `merchan26_42_2_`, `product2_`.`customer_id` AS `custome27_42_2_`, `product2_`.`preorder` AS `preorder8_42_2_`, `product2_`.`product_height` AS `product_9_42_2_`, `product2_`.`product_free` AS `product10_42_2_`, `product2_`.`product_length` AS `product11_42_2_`, `product2_`.`quantity_ordered` AS `quantit12_42_2_`, `product2_`.`review_avg` AS `review_13_42_2_`, `product2_`.`review_count` AS `review_14_42_2_`, `product2_`.`product_ship` AS `product15_42_2_`, `product2_`.`product_virtual` AS `product16_42_2_`, `product2_`.`product_weight` AS `product17_42_2_`, `product2_`.`product_width` AS `product18_42_2_`, `product2_`.`ref_sku` AS `ref_sku19_42_2_`, `product2_`.`rental_duration` AS `rental_20_42_2_`, `product2_`.`rental_period` AS `rental_21_42_2_`, `product2_`.`rental_status` AS `rental_22_42_2_`, `product2_`.`sku` AS `sku23_42_2_`, `product2_`.`sort_order` AS `sort_or24_42_2_`, `product2_`.`tax_class_id` AS `tax_cla28_42_2_`, `product2_`.`product_type_id` AS `product29_42_2_`, `descriptio3_`.`date_created` AS `date_cre2_46_3_`, `descriptio3_`.`date_modified` AS `date_mod3_46_3_`, `descriptio3_`.`updt_id` AS `updt_id4_46_3_`, `descriptio3_`.`description` AS `descript5_46_3_`, `descriptio3_`.`language_id` AS `languag14_46_3_`, `descriptio3_`.`name` AS `name6_46_3_`, `descriptio3_`.`title` AS `title7_46_3_`, `descriptio3_`.`meta_description` AS `meta_des8_46_3_`, `descriptio3_`.`meta_keywords` AS `meta_key9_46_3_`, `descriptio3_`.`meta_title` AS `meta_ti10_46_3_`, `descriptio3_`.`product_id` AS `product15_46_3_`, `descriptio3_`.`download_lnk` AS `downloa11_46_3_`, `descriptio3_`.`product_highlight` AS `product12_46_3_`, `descriptio3_`.`sef_url` AS `sef_url13_46_3_`, `descriptio3_`.`product_id` AS `product15_46_0__`, `descriptio3_`.`description_id` AS `descript1_46_0__` FROM `product_relationship` AS `productrel0_` INNER JOIN `product` AS `product2_` ON `productrel0_`.`related_product_id` = `product2_`.`product_id` INNER JOIN `product` AS `product1_` ON `productrel0_`.`product_id` = `product1_`.`product_id` INNER JOIN `product_description` AS `descriptio3_` ON `product2_`.`product_id` = `descriptio3_`.`product_id` WHERE `productrel0_`.`code` = 'RELATED_ITEM' AND `productrel0_`.`merchant_id` = 1 AND `product1_`.`product_id` = 2 AND `descriptio3_`.`language_id` = 1",
        };
    doTest(appName, stmtId, expected);
  }

  //  @Test // 134
  void testShopizer119() {
    final String appName = "shopizer";
    final int stmtId = 119;
    final String[] expected =
        new String[] {
          "SELECT `productrel0_`.`product_relationship_id` AS `product_1_56_0_`, `product1_`.`product_id` AS `product_1_42_1_`, `product2_`.`product_id` AS `product_1_42_2_`, `descriptio3_`.`description_id` AS `descript1_46_3_`, `productrel0_`.`active` AS `active2_56_0_`, `productrel0_`.`code` AS `code3_56_0_`, `productrel0_`.`product_id` AS `product_4_56_0_`, `productrel0_`.`related_product_id` AS `related_5_56_0_`, `productrel0_`.`merchant_id` AS `merchant6_56_0_`, `product1_`.`date_created` AS `date_cre2_42_1_`, `product1_`.`date_modified` AS `date_mod3_42_1_`, `product1_`.`updt_id` AS `updt_id4_42_1_`, `product1_`.`available` AS `availabl5_42_1_`, `product1_`.`cond` AS `cond6_42_1_`, `product1_`.`date_available` AS `date_ava7_42_1_`, `product1_`.`manufacturer_id` AS `manufac25_42_1_`, `product1_`.`merchant_id` AS `merchan26_42_1_`, `product1_`.`customer_id` AS `custome27_42_1_`, `product1_`.`preorder` AS `preorder8_42_1_`, `product1_`.`product_height` AS `product_9_42_1_`, `product1_`.`product_free` AS `product10_42_1_`, `product1_`.`product_length` AS `product11_42_1_`, `product1_`.`quantity_ordered` AS `quantit12_42_1_`, `product1_`.`review_avg` AS `review_13_42_1_`, `product1_`.`review_count` AS `review_14_42_1_`, `product1_`.`product_ship` AS `product15_42_1_`, `product1_`.`product_virtual` AS `product16_42_1_`, `product1_`.`product_weight` AS `product17_42_1_`, `product1_`.`product_width` AS `product18_42_1_`, `product1_`.`ref_sku` AS `ref_sku19_42_1_`, `product1_`.`rental_duration` AS `rental_20_42_1_`, `product1_`.`rental_period` AS `rental_21_42_1_`, `product1_`.`rental_status` AS `rental_22_42_1_`, `product1_`.`sku` AS `sku23_42_1_`, `product1_`.`sort_order` AS `sort_or24_42_1_`, `product1_`.`tax_class_id` AS `tax_cla28_42_1_`, `product1_`.`product_type_id` AS `product29_42_1_`, `product2_`.`date_created` AS `date_cre2_42_2_`, `product2_`.`date_modified` AS `date_mod3_42_2_`, `product2_`.`updt_id` AS `updt_id4_42_2_`, `product2_`.`available` AS `availabl5_42_2_`, `product2_`.`cond` AS `cond6_42_2_`, `product2_`.`date_available` AS `date_ava7_42_2_`, `product2_`.`manufacturer_id` AS `manufac25_42_2_`, `product2_`.`merchant_id` AS `merchan26_42_2_`, `product2_`.`customer_id` AS `custome27_42_2_`, `product2_`.`preorder` AS `preorder8_42_2_`, `product2_`.`product_height` AS `product_9_42_2_`, `product2_`.`product_free` AS `product10_42_2_`, `product2_`.`product_length` AS `product11_42_2_`, `product2_`.`quantity_ordered` AS `quantit12_42_2_`, `product2_`.`review_avg` AS `review_13_42_2_`, `product2_`.`review_count` AS `review_14_42_2_`, `product2_`.`product_ship` AS `product15_42_2_`, `product2_`.`product_virtual` AS `product16_42_2_`, `product2_`.`product_weight` AS `product17_42_2_`, `product2_`.`product_width` AS `product18_42_2_`, `product2_`.`ref_sku` AS `ref_sku19_42_2_`, `product2_`.`rental_duration` AS `rental_20_42_2_`, `product2_`.`rental_period` AS `rental_21_42_2_`, `product2_`.`rental_status` AS `rental_22_42_2_`, `product2_`.`sku` AS `sku23_42_2_`, `product2_`.`sort_order` AS `sort_or24_42_2_`, `product2_`.`tax_class_id` AS `tax_cla28_42_2_`, `product2_`.`product_type_id` AS `product29_42_2_`, `descriptio3_`.`date_created` AS `date_cre2_46_3_`, `descriptio3_`.`date_modified` AS `date_mod3_46_3_`, `descriptio3_`.`updt_id` AS `updt_id4_46_3_`, `descriptio3_`.`description` AS `descript5_46_3_`, `descriptio3_`.`language_id` AS `languag14_46_3_`, `descriptio3_`.`name` AS `name6_46_3_`, `descriptio3_`.`title` AS `title7_46_3_`, `descriptio3_`.`meta_description` AS `meta_des8_46_3_`, `descriptio3_`.`meta_keywords` AS `meta_key9_46_3_`, `descriptio3_`.`meta_title` AS `meta_ti10_46_3_`, `descriptio3_`.`product_id` AS `product15_46_3_`, `descriptio3_`.`download_lnk` AS `downloa11_46_3_`, `descriptio3_`.`product_highlight` AS `product12_46_3_`, `descriptio3_`.`sef_url` AS `sef_url13_46_3_`, `descriptio3_`.`product_id` AS `product15_46_0__`, `descriptio3_`.`description_id` AS `descript1_46_0__` FROM `product_relationship` AS `productrel0_` INNER JOIN `product` AS `product2_` ON `productrel0_`.`related_product_id` = `product2_`.`product_id` INNER JOIN `product` AS `product1_` ON `productrel0_`.`product_id` = `product1_`.`product_id` INNER JOIN `product_description` AS `descriptio3_` ON `product2_`.`product_id` = `descriptio3_`.`product_id` WHERE `productrel0_`.`code` = 'RELATED_ITEM' AND `productrel0_`.`merchant_id` = 1 AND `product1_`.`product_id` = 2 AND `descriptio3_`.`language_id` = 1",
        };
    doTest(appName, stmtId, expected);
  }

  @Test // 146
  void testSolidus551() {
    final String appName = "solidus";
    final int stmtId = 551;
    final String[] expected =
        new String[] {
          "SELECT `spree_shipping_methods`.`id` AS `id`, `spree_shipping_methods`.`name` AS `name`, `spree_shipping_methods`.`deleted_at` AS `deleted_at`, `spree_shipping_methods`.`created_at` AS `created_at`, `spree_shipping_methods`.`updated_at` AS `updated_at`, `spree_shipping_methods`.`tracking_url` AS `tracking_url`, `spree_shipping_methods`.`admin_name` AS `admin_name`, `spree_shipping_methods`.`tax_category_id` AS `tax_category_id`, `spree_shipping_methods`.`code` AS `code`, `spree_shipping_methods`.`available_to_all` AS `available_to_all`, `spree_shipping_methods`.`carrier` AS `carrier`, `spree_shipping_methods`.`service_level` AS `service_level`, `spree_shipping_methods`.`available_to_users` AS `available_to_users` FROM `spree_shipping_method_zones` AS `spree_shipping_method_zones` INNER JOIN `spree_shipping_method_stock_locations` AS `spree_shipping_method_stock_locations` ON `spree_shipping_method_zones`.`shipping_method_id` = `spree_shipping_method_stock_locations`.`shipping_method_id` INNER JOIN `spree_shipping_methods` AS `spree_shipping_methods` ON `spree_shipping_method_zones`.`shipping_method_id` = `spree_shipping_methods`.`id` INNER JOIN `spree_zone_members` AS `spree_zone_members` ON `spree_shipping_method_zones`.`zone_id` = `spree_zone_members`.`zone_id` WHERE `spree_shipping_methods`.`id` IN (SELECT `spree_shipping_methods`.`id` FROM `spree_shipping_methods` INNER JOIN `spree_shipping_method_categories` ON `spree_shipping_method_categories`.`shipping_method_id` = `spree_shipping_methods`.`id` WHERE `spree_shipping_methods`.`deleted_at` IS NULL AND `spree_shipping_method_categories`.`shipping_category_id` = 544 GROUP BY `spree_shipping_methods`.`id` HAVING COUNT(DISTINCT `spree_shipping_method_categories`.`id`) = 1) AND (`spree_shipping_methods`.`available_to_all` = TRUE OR `spree_shipping_method_stock_locations`.`stock_location_id` IS NULL) AND `spree_shipping_methods`.`deleted_at` IS NULL AND (`spree_zone_members`.`zoneable_type` = 'Spree::State' AND `spree_zone_members`.`zoneable_id` IN (?) OR `spree_zone_members`.`zoneable_type` = 'Spree::Country' AND `spree_zone_members`.`zoneable_id` IN (?))",
        };
    doTest(appName, stmtId, expected);
  }
}
